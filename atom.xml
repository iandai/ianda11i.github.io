<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Ian's Tech Note]]></title>
  <link href="http://iandai.github.io/atom.xml" rel="self"/>
  <link href="http://iandai.github.io/"/>
  <updated>2018-08-01T22:21:36+02:00</updated>
  <id>http://iandai.github.io/</id>
  <author>
    <name><![CDATA[Ian Dai]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Thoughts on Refactor 一次重构的思考]]></title>
    <link href="http://iandai.github.io/blog/2018/08/01/thoughts-on-re%5B%3F%5D-ci-zhong-gou-de-si-kao/"/>
    <updated>2018-08-01T22:09:29+02:00</updated>
    <id>http://iandai.github.io/blog/2018/08/01/thoughts-on-re[?]-ci-zhong-gou-de-si-kao</id>
    <content type="html"><![CDATA[<p>加入公司的时候，iOS客户端代码比较混乱。<br/>
比如有一些方法非常的长，包含了许多逻辑；许多无用的代码等。<br/>
原来的代码主要是由几个不同的freelancer写成的，所以代码一方面难以理解，一方面也不容易维护和增加新功能。<br/>
所以进行了一次重构。</p>

<h3>重构项目最重要的是什么？</h3>

<p>项目责任人的真正的认可和支持。他需要理解重构需要花费的成本和能够获取的收益。<br/>
重构花费的成本，只能看见不多的业务收益。<br/>
只有项目负责人真正认可，才能在项目没有明显进度的时候，顶住压力，正确制定项目进度计划。<br/>
对开发人员来说，也需要理解这种情况。在重构的时候，尽量能提升构架的同时，也要有业务方面的收益。</p>

<h3>重构的目标</h3>

<p>技术上的目标：有清晰的分层，尽可能解藕，以提高可读性和可扩展性为主；减少逻辑混乱带来的一些bug。<br/>
业务上的目标：优化部分功能；解决语言国际化上的不足；提升对多种设备的多方面支持。<br/>
范围上的目标：全部重写所有逻辑，会耗费非常多的时间。重构抓大放小，主要重构经常访问的模块，如用户登陆模块，Index模块，项目模块。</p>

<h3>重构的步骤</h3>

<p>1，删除不用的图片和代码<br/>
2，解决一部分Warning，比如变量未使用<br/>
3，重新组织文件目录结构<br/>
4，抽象出模块<br/>
5，统一代码规范<br/>
6，修复一个bug或者建立一个新功能，就重构相关的代码，以尽量缩小影响范围</p>

<h3>文件目录结构</h3>

<p>Top layer</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-[ProjectName]
</span><span class='line'>    --Features       
</span><span class='line'>    --Categories   
</span><span class='line'>    --Frameworks 
</span><span class='line'>    --Helpers  
</span><span class='line'>    --Utilites    
</span><span class='line'>    --Vendors     
</span><span class='line'>    --Config   
</span><span class='line'>    --Resources     
</span><span class='line'>    --AppEntry 
</span><span class='line'>-Tests
</span><span class='line'>-UITests
</span><span class='line'>-Products         
</span><span class='line'>-Pods</span></code></pre></td></tr></table></div></figure>


<p>Second layer</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>--Features         
</span><span class='line'>    ---Base            
</span><span class='line'>        ----Models      
</span><span class='line'>        ----Views       
</span><span class='line'>        ----Controllers 
</span><span class='line'>        ----Managers      
</span><span class='line'>    ---Login
</span><span class='line'>        ----Models
</span><span class='line'>        ----Views
</span><span class='line'>        ----Controllers
</span><span class='line'>        ----Managers      
</span><span class='line'>    ---Profile
</span><span class='line'>        ----Models
</span><span class='line'>        ----Views
</span><span class='line'>        ----Controllers
</span><span class='line'>        ----Managers      
</span><span class='line'>    ---Home
</span><span class='line'>        ----Models
</span><span class='line'>        ----Views
</span><span class='line'>        ----Controllers
</span><span class='line'>        ----Managers      </span></code></pre></td></tr></table></div></figure>


<h3>代码规范</h3>

<p>1, Follow <a href="https://github.com/NYTimes/objective-c-style-guide">NYTimes objective-c style</a><br/>
2, Use <a href="https://github.com/mapbox/XcodeClangFormat">XcodeClangFormat</a> to format source code to unify the source code style.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[UITableView Adaption With iPhoneX]]></title>
    <link href="http://iandai.github.io/blog/2018/05/25/uitableview-adaption-with-iphonex/"/>
    <updated>2018-05-25T14:26:28+02:00</updated>
    <id>http://iandai.github.io/blog/2018/05/25/uitableview-adaption-with-iphonex</id>
    <content type="html"><![CDATA[<h2>问题</h2>

<p>UITableView在iPhoneX上会有20pt/64pt的偏移。<br/>
其原因是由于iOS11废弃了UIViewController的automaticallyAdjustsScrollViewInsets属性，新增了contentInsetAdjustmentBehavior属性。  所以当超出安全区域时系统自动调整了SafeAreaInsets，进而影响了adjustedContentInset，在iOS11中决定tableView内容与边缘距离的是adjustedContentInset，所以需要设置UIScrollView的contentInsetAdjustmentBehavior属性。</p>

<h2>解决方法</h2>

<h3>1.手动适配</h3>

<p>如果你使用了UITableView、UIScrollView，可以直接使用以下代码做适配，这样系统就不会主动为你设置边缘距离，但是你可能需要手动适配UITableView的contenteInset。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='Objc'><span class='line'>  <span class="cp">#ifdef __IPHONE_11_0  </span>
</span><span class='line'>  <span class="c1">// 单独作用与某个tableView</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="n">tableView</span> <span class="nl">respondsToSelector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nl">setContentInsetAdjustmentBehavior</span><span class="p">:)])</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">tableView</span><span class="p">.</span><span class="n">contentInsetAdjustmentBehavior</span> <span class="o">=</span> <span class="n">UIScrollViewContentInsetAdjustmentNever</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="c1">// 作用与所有的UIScrollView</span>
</span><span class='line'>  <span class="bp">UIScrollView</span><span class="p">.</span><span class="n">appearance</span><span class="p">.</span><span class="n">contentInsetAdjustmentBehavior</span> <span class="o">=</span> <span class="n">UIScrollViewContentInsetAdjustmentNever</span><span class="p">;</span>
</span><span class='line'>  <span class="c1">// 设置view的宽高</span>
</span><span class='line'>  <span class="n">tableView</span><span class="p">.</span><span class="n">contentInset</span> <span class="o">=</span> <span class="n">UIEdgeInsetsMake</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>  <span class="cp">#endif</span>
</span></code></pre></td></tr></table></div></figure>


<h3>2.自动适配</h3>

<p>设置contentInsetAdjustmentBehavior属性为UIScrollViewContentInsetAdjustmentAutomatic，则系统会自动计算contentView的偏移量。</p>

<h3>3.设置安全区域的addtionalSafeAreaInset</h3>

<p>某些情况下，你需要顶部区域，比如广告区域覆盖Status，则可以设置相应页面的addtionalSafeAreaInset属性，这样系统不会将safeArea上调到从status开始。这样可以提供更好的用户体验。<br/>
例如如果你的SafeAreaInset值为(44,0,0,0)，则需要设置相应的additionalSafeAreaInsets值为(-44,0,0,0)。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='Objc'><span class='line'>  <span class="k">if</span> <span class="p">(@</span><span class="n">available</span><span class="p">(</span><span class="n">iOS</span> <span class="mf">11.0</span><span class="p">,</span> <span class="o">*</span><span class="p">))</span> <span class="p">{</span>
</span><span class='line'>      <span class="nb">self</span><span class="p">.</span><span class="n">additionalSafeAreaInsets</span> <span class="o">=</span> <span class="n">UIEdgeInsetsMake</span><span class="p">(</span><span class="o">-</span><span class="mi">44</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// Fallback on earlier versions</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>4.自动估算行高</h3>

<p>iOS11开始UITableView开启了自动估算行高，estimatedRowHeight estimatedSectionHeaderHeight estimatedSectionFooterHeight 三个高度估算属性由默认的0变成了UITableViewAutomaticDimension。  所以heightForHeaderInSection和viewForHeaderInSection应该一起使用，不然tableView顶部滑动的时候会有空白。<br/>
在适配过程中发现UITableView会在Header/Footer返回size为负值的情况下会崩溃。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[NSString, Unicode和NSCharacterSet]]></title>
    <link href="http://iandai.github.io/blog/2017/01/05/nsstring-unicodehe-nscharacterset/"/>
    <updated>2017-01-05T15:57:17+01:00</updated>
    <id>http://iandai.github.io/blog/2017/01/05/nsstring-unicodehe-nscharacterset</id>
    <content type="html"><![CDATA[<h2>Unicode</h2>

<h3>Convert unicode ponit to eomji using universal character names</h3>

<blockquote><p>Universal character names are formed by a prefix \U followed by an eight-digit Unicode code point, or by a prefix \u followed by a four digit Unicode code point.
For Unicode surrogate pairs, specify the universal character name by using \UNNNNNNNN, where NNNNNNNN is the eight-digit code point for the character. The compiler generates a surrogate pair if required.
In Objc, \U also handles Emoji ZWJ Sequences.</p></blockquote>

<p>For example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// 用Universal character names \U和\u 替换
</span><span class='line'>NSString *str = @"The Greek letter Beta looks like this: \u03b2, and the emoji for books looks like this: \U00010437";
</span><span class='line'>NSLog(@"%@", str);
</span><span class='line'>
</span><span class='line'>// 处理 Surrogate Pairs
</span><span class='line'>// 方法一
</span><span class='line'>NSString *str2 = [NSString stringWithCharacters:(unichar[]){0x263A, 0xFE0F} length:2];
</span><span class='line'>NSLog(@"%@", str2);
</span><span class='line'>// 方法二
</span><span class='line'>NSString *str3 = [NSString stringWithFormat:@"\U0000263A\U0000FE0F"];
</span><span class='line'>NSLog(@"%@", str3);
</span><span class='line'>// 方法三
</span><span class='line'>// NSString  initWithBytes
</span><span class='line'>// supports Surrogate Pairs, does not support Emoji ZWJ Sequences
</span><span class='line'>const unichar chars1[] = {0x263A, 0xFE0F};
</span><span class='line'>NSString *str4 = [[NSString alloc] initWithBytes:chars1 length:sizeof(chars1) encoding:NSUTF16LittleEndianStringEncoding];
</span><span class='line'>NSLog(@"%@", str4);
</span><span class='line'>// 方法四
</span><span class='line'>// NSString  initWithBytes
</span><span class='line'>// works on utf32
</span><span class='line'>uint32_t base_point_UTF32 = 0x1F600;
</span><span class='line'>NSString *str5 = [[NSString alloc] initWithBytes:&base_point_UTF32 length:4 encoding:NSUTF32LittleEndianStringEncoding];
</span><span class='line'>NSLog(@"%@", str5);
</span><span class='line'>// 方法五
</span><span class='line'>//CFStringGetSurrogatePairForLongCharacter
</span><span class='line'>UniChar c[2];
</span><span class='line'>CFStringGetSurrogatePairForLongCharacter(0x1F600, c);
</span><span class='line'>NSString *str6 = [[NSString alloc] initWithCharacters:c length:2];
</span><span class='line'>NSLog(@"%@", str6);
</span><span class='line'>
</span><span class='line'>// 处理Emoji ZWJ Sequences
</span><span class='line'>// 方法一
</span><span class='line'>NSString *str7 = [NSString stringWithFormat:@"\U0001F468\U0000200D\U00002695\U0000FE0F"];
</span><span class='line'>NSLog(@"%@", str7);
</span><span class='line'>// 方法二
</span><span class='line'>NSString *str8 = [NSString stringWithFormat:@"👨\u200D👩\u200D👧\u200D👦"]; //👨‍👩‍👧‍👦
</span><span class='line'>NSLog(@"%@", str8);
</span></code></pre></td></tr></table></div></figure>


<h2>CharacterSet</h2>

<h3>检测CharacterSet包含了哪些字符</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='Objc'><span class='line'><span class="bp">NSCharacterSet</span> <span class="o">*</span><span class="n">charSet</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSCharacterSet</span> <span class="n">symbolCharacterSet</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="kt">unichar</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">65535</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">([</span><span class="n">charSet</span> <span class="nl">characterIsMember</span><span class="p">:</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;character %d = %C&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
</span><span class='line'>      <span class="n">count</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;found %d characters out of 65536&quot;</span><span class="p">,</span><span class="n">count</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h2>More about unicode and emoji</h2>

<p><a href="http://www.unicode.org/faq/emoji_dingbats.html">Emoji and Pictographs</a><br/>
<a href="http://cyrilwei.me/swift/2016/08/31/the-emoji.html">The Emoji, is not what you expected</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[如何检测和删除NSString中的颜文字Emoji]]></title>
    <link href="http://iandai.github.io/blog/2017/01/05/ru-he-jian-ce-he-shan-chu-nsstringzhong-de-yan-wen-zi-emoji/"/>
    <updated>2017-01-05T14:52:29+01:00</updated>
    <id>http://iandai.github.io/blog/2017/01/05/ru-he-jian-ce-he-shan-chu-nsstringzhong-de-yan-wen-zi-emoji</id>
    <content type="html"><![CDATA[<h2>问题</h2>

<p>有一个需求是获取联系人姓名的首字母，使用一个或多个首字母绘制联系人用户头像。有的用户名字首字母是颜文字，绘制就会出现乱码。代码如下：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='Objc'><span class='line'><span class="bp">NSMutableString</span> <span class="o">*</span><span class="n">initials</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSMutableString</span> <span class="n">string</span><span class="p">];</span>
</span><span class='line'><span class="bp">NSArray</span> <span class="o">*</span><span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">contactName</span> <span class="nl">componentsSeparatedByCharactersInSet</span><span class="p">:[</span><span class="bp">NSCharacterSet</span> <span class="n">whitespaceCharacterSet</span><span class="p">]];</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="n">word</span> <span class="k">in</span> <span class="n">words</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">word</span><span class="p">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="bp">NSString</span> <span class="o">*</span><span class="n">firstLetter</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="nl">substringToIndex</span><span class="p">:</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>        <span class="p">[</span><span class="n">initials</span> <span class="nl">appendString</span><span class="p">:[</span><span class="n">firstLetter</span> <span class="n">uppercaseString</span><span class="p">]];</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>乱码来自于名字中的颜文字，当<code>[word substringToIndex:1]</code>中的word是颜文字的时候，其返回值并不是一个正常的颜文字。</p>

<p>原因是<code>[word length]</code>结果是2，所以<code>[word substringToIndex:1]</code>其实只返回了颜文字的一半。</p>

<p>为什么会出现这种情况呢？这是因为<code>word</code>是一个NSString类型，而NSString是UTF-16编码的。许多颜文字在使用UTF-16表示的时候，要是用两个字节才能表示，比如😀。</p>

<p>NSString类的<a href="https://developer.apple.com/reference/foundation/nsstring">文档</a>里写到：</p>

<blockquote><p>An NSString object encodes a Unicode-compliant text string, represented as a sequence of UTF–16 code units. All lengths, character
indexes, and ranges are expressed in terms of 16-bit platform-endian values, with index values starting at 0.</p></blockquote>

<h2>解决方法</h2>

<h3>1.从字符串中获得正确完整的字符</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='Objc'><span class='line'><span class="k">__block</span> <span class="bp">NSString</span> <span class="o">*</span><span class="n">firstLetter</span> <span class="o">=</span> <span class="s">@&quot;&quot;</span><span class="p">;</span>
</span><span class='line'><span class="p">[</span><span class="n">word</span> <span class="nl">enumerateSubstringsInRange</span><span class="p">:</span><span class="n">NSMakeRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="n">word</span> <span class="n">length</span><span class="p">])</span>
</span><span class='line'>                         <span class="nl">options</span><span class="p">:</span><span class="n">NSStringEnumerationByComposedCharacterSequences</span>
</span><span class='line'>                      <span class="nl">usingBlock</span><span class="p">:</span> <span class="o">^</span><span class="p">(</span><span class="bp">NSString</span><span class="o">*</span> <span class="n">substring</span><span class="p">,</span> <span class="n">NSRange</span> <span class="n">substringRange</span><span class="p">,</span> <span class="n">NSRange</span> <span class="n">enclosingRange</span><span class="p">,</span> <span class="kt">BOOL</span><span class="o">*</span> <span class="n">stop</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                          <span class="n">firstLetter</span> <span class="o">=</span> <span class="n">substring</span><span class="p">;</span>
</span><span class='line'>                          <span class="o">*</span><span class="n">stop</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'>                      <span class="p">}];</span>
</span></code></pre></td></tr></table></div></figure>


<p>使用<code>NSStringEnumerationByComposedCharacterSequences</code>能够读取完整的颜文字，而不是只读取其中一个字节。</p>

<h3>2.检测和删除是否包含颜文字</h3>

<p>Github上有一个比较多人参考的项目<a href="https://github.com/woxtu/NSString-RemoveEmoji">NSString-RemoveEmoj</a>。这个项目有遗漏颜文字，比如⭐，包含了许多不是颜文字的字符，比如Ⅶ。</p>

<p>在unicode.org网站上，有<a href="http://unicode.org/Public/emoji/4.0/emoji-test.txt">完整的颜文字列表</a>。遍历这个完整的列表，就可以检测字符串中是否颜文字。方法如下：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='Objc'><span class='line'><span class="c1">// 建立一个emoji CharacterSet</span>
</span><span class='line'><span class="bp">NSMutableCharacterSet</span> <span class="o">*</span><span class="n">emojiCharacterSet</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSMutableCharacterSet</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'><span class="bp">NSString</span> <span class="o">*</span><span class="n">plistPath</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSBundle</span> <span class="n">mainBundle</span><span class="p">]</span> <span class="nl">pathForResource</span><span class="p">:</span><span class="s">@&quot;emoji&quot;</span> <span class="nl">ofType</span><span class="p">:</span><span class="s">@&quot;plist&quot;</span><span class="p">];</span>
</span><span class='line'><span class="bp">NSArray</span> <span class="o">*</span><span class="n">emojiArr</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSArray</span> <span class="nl">arrayWithContentsOfFile</span><span class="p">:</span><span class="n">plistPath</span><span class="p">];</span>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="n">emoji</span> <span class="k">in</span> <span class="n">emojiArr</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">[</span><span class="n">emojiCharacterSet</span> <span class="nl">addCharactersInString</span><span class="p">:</span><span class="n">emoji</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// - (NSRange)rangeOfCharacterFromSet:(NSCharacterSet *)searchSet;</span>
</span><span class='line'><span class="p">[</span><span class="s">@&quot;😀&quot;</span> <span class="nl">rangeOfCharacterFromSet</span><span class="p">:</span><span class="n">set</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>上面代码还有一个问题没有被考虑。比如下面这种情况：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='Objc'><span class='line'><span class="bp">NSMutableCharacterSet</span> <span class="o">*</span><span class="n">set</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSMutableCharacterSet</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">set</span> <span class="nl">addCharactersInString</span><span class="p">:</span><span class="s">@&quot;2️⃣&quot;</span><span class="p">];</span>      <span class="c1">// keycap 2, 0032 FE0F 20E3, check from http://www.iemoji.com/view/emoji/296/symbols/keycap-2 </span>
</span><span class='line'><span class="p">[</span><span class="s">@&quot;2&quot;</span> <span class="nl">rangeOfCharacterFromSet</span><span class="p">:</span><span class="n">set</span><span class="p">];</span>     <span class="c1">// return value: YES, which is not reasonable </span>
</span></code></pre></td></tr></table></div></figure>


<p>字符2在搜索包含有颜文字2的字符集的时候，会被错误的检测出来。</p>

<p>为了解决这个问题，我写了<a href="https://github.com/iandai/IDEmojiString">IDEmojiString项目</a>。</p>

<h3>3.IDEmojiString</h3>

<p>IDEmojiString通过使单字符和多字符分别搜索字符集，解决了上面的问题。</p>

<p>使用CocoaPods安装之后，通过以下方法使用：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='Objc'><span class='line'><span class="c1">//#import &quot;IDEmojiManager.h&quot;</span>
</span><span class='line'><span class="n">IDEmojiManager</span> <span class="o">*</span><span class="n">manager</span> <span class="o">=</span> <span class="p">[[</span><span class="n">IDEmojiManager</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'><span class="kt">BOOL</span> <span class="n">containsEmoji</span> <span class="o">=</span> <span class="p">[</span><span class="n">manager</span> <span class="nl">containEmojiInString</span><span class="p">:</span><span class="s">@&quot;Some String⭐&quot;</span><span class="p">];</span>  <span class="c1">// return value: YES</span>
</span><span class='line'><span class="bp">NSString</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="p">[</span><span class="n">manager</span> <span class="nl">removeEmojiFromString</span><span class="p">:</span><span class="s">@&quot;Some String⭐&quot;</span><span class="p">];</span>      <span class="c1">// return value: Some String</span>
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Optional in Swift -- 使用Swift Optional的好处]]></title>
    <link href="http://iandai.github.io/blog/2016/08/20/optional-in-swift-shi-yong-swift-optionalde-hao-chu/"/>
    <updated>2016-08-20T16:57:38+02:00</updated>
    <id>http://iandai.github.io/blog/2016/08/20/optional-in-swift-shi-yong-swift-optionalde-hao-chu</id>
    <content type="html"><![CDATA[<p>看这篇文章之前，需要了解Swift中<a href="https://developer.apple.com/library/ios/referencelibrary/GettingStarted/DevelopiOSAppsSwift/Lesson1.html#//apple_ref/doc/uid/TP40015214-CH3-SW1">Optional的基础知识</a>。</p>

<p>作为写了几年的Objective-c的开发者，对在Swift中使用Optional持有过怀疑态度。使用了Optional，需要添加烦人的？和！。使用了？和！之后，依然需要做nil检查；使用了Value！之后，依然会在运行时因为nil问题而crash。</p>

<p>使用Optional有什么意义呢？</p>

<h2>使用理由1: 预先定义好通用的对象不存在的时候的写法</h2>

<p>考虑下面的例子：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">findStockCode:</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">company</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">([</span><span class="n">company</span> <span class="nl">isEqualToString</span><span class="p">:</span><span class="s">@&quot;Apple&quot;</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">@&quot;AAPL&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">([</span><span class="n">company</span> <span class="nl">isEqualToString</span><span class="p">:</span><span class="s">@&quot;Google&quot;</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">@&quot;GOOG&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>可以使用findStockCode:方法来获取某个上市公司的股票代码。<br/>
也有的开发者会使用下面的方法来写，找不到的时候返回空字符串。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">findStockCode:</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">company</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">([</span><span class="n">company</span> <span class="nl">isEqualToString</span><span class="p">:</span><span class="s">@&quot;Apple&quot;</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">@&quot;AAPL&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">([</span><span class="n">company</span> <span class="nl">isEqualToString</span><span class="p">:</span><span class="s">@&quot;Google&quot;</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">@&quot;GOOG&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>如何确定找不到该公司代码的时候，返回的是空字符串还是nil呢？调用该方法的开发者，需要阅读文档或者处理多种情况。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="bp">NSString</span> <span class="o">*</span><span class="n">stockCode</span> <span class="o">=</span> <span class="p">[</span><span class="nb">self</span> <span class="nl">findStockCode</span><span class="p">:</span><span class="s">@&quot;Facebook&quot;</span><span class="p">];</span>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="n">stockCode</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">stockCode</span> <span class="o">==</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="p">.....</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>在Swift中，这种情况非常明显的要使用Optional。如果找不到，则返回nil。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">func</span> <span class="nf">findStockCode</span> <span class="p">(</span><span class="nl">company</span> <span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">String</span><span class="o">?</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">company</span> <span class="o">==</span> <span class="s">&quot;Apple&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">&quot;AAPL&quot;</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="nf">if</span><span class="p">(</span><span class="n">company</span> <span class="o">==</span> <span class="s">&quot;Google&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">&quot;GOOG&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nb">nil</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>使用理由2: 编译的时候提示错误</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">findStockCode:</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">company</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">([</span><span class="n">company</span> <span class="nl">isEqualToString</span><span class="p">:</span><span class="s">@&quot;Apple&quot;</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">@&quot;AAPL&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">([</span><span class="n">company</span> <span class="nl">isEqualToString</span><span class="p">:</span><span class="s">@&quot;Google&quot;</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">@&quot;GOOG&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="bp">NSString</span> <span class="o">*</span><span class="n">stockCode</span> <span class="o">=</span> <span class="p">[</span><span class="nb">self</span> <span class="nl">findStockCode</span><span class="p">:</span><span class="s">@&quot;Facebook&quot;</span><span class="p">];</span> <span class="c1">// nil is returned</span>
</span><span class='line'><span class="bp">NSString</span> <span class="o">*</span><span class="n">text</span> <span class="o">=</span> <span class="s">@&quot;Stock Code - &quot;</span><span class="p">;</span>
</span><span class='line'><span class="bp">NSString</span> <span class="o">*</span><span class="n">message</span> <span class="o">=</span> <span class="p">[</span><span class="n">text</span> <span class="nl">stringByAppendingString</span><span class="p">:</span><span class="n">stockCode</span><span class="p">];</span> <span class="c1">// runtime error</span>
</span><span class='line'><span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;%@&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>当用Objective-C的时候，<code>[text stringByAppendingString:stockCode]</code>中，给NSString添加nil的时候，在运行时出错。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">func</span> <span class="nf">findStockCode</span><span class="p">(</span><span class="nl">company</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">String</span><span class="o">?</span> <span class="p">{</span>
</span><span class='line'>   <span class="k">if</span> <span class="p">(</span><span class="n">company</span> <span class="o">==</span> <span class="s">&quot;Apple&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="s">&quot;AAPL&quot;</span>
</span><span class='line'>   <span class="p">}</span> <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">company</span> <span class="o">==</span> <span class="s">&quot;Google&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="s">&quot;GOOG&quot;</span>
</span><span class='line'>   <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>   <span class="k">return</span> <span class="nb">nil</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">var</span> <span class="nl">stockCode</span><span class="p">:</span><span class="n">String</span><span class="o">?</span> <span class="o">=</span> <span class="n">findStockCode</span><span class="p">(</span><span class="s">&quot;Facebook&quot;</span><span class="p">)</span>
</span><span class='line'><span class="k">let</span> <span class="n">text</span> <span class="o">=</span> <span class="s">&quot;Stock Code - &quot;</span>
</span><span class='line'><span class="k">let</span> <span class="n">message</span> <span class="o">=</span> <span class="n">text</span> <span class="o">+</span> <span class="n">stockCode</span>  <span class="c1">// compile-time error</span>
</span><span class='line'><span class="n">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>当用Swift的时候，<code>let message = text + stockCode</code>中，Xcode会主动提示stockCode可能会是nil的情况，需要开发者进一步处理。</p>

<h2>使用理由3: 强迫思考nil问题，crash容易发现问题</h2>

<p>上面的Swift代码中，要解决complile-time error，可以用加！来forced unwrapping。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">var</span> <span class="nl">stockCode</span><span class="p">:</span><span class="n">String</span><span class="o">?</span> <span class="o">=</span> <span class="n">findStockCode</span><span class="p">(</span><span class="s">&quot;Facebook&quot;</span><span class="p">)</span>
</span><span class='line'><span class="k">let</span> <span class="n">text</span> <span class="o">=</span> <span class="s">&quot;Stock Code - &quot;</span>
</span><span class='line'><span class="k">let</span> <span class="n">message</span> <span class="o">=</span> <span class="n">text</span> <span class="o">+</span> <span class="n">stockCode</span><span class="o">!</span>  <span class="c1">// runtime error</span>
</span></code></pre></td></tr></table></div></figure>


<p>这段代码可以通过编译，但是在runtime的时候，还是会出错。<br/>
抛出：“fatal error: Can’t unwrap Optional.None”。<br/>
在使用！进行forced unwrapping的时候，开发者被迫思考是要forced unwrapping，还是stockCode有可能是nil。<br/>
这有利于减少犯错的机会。而如果出错了，提示的消息也非常容易找到问题所在。</p>

<h2>使用理由4: 简化nil检查写法(optional chaining)</h2>

<p>考虑这个例子</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='swift'><span class='line'><span class="k">class</span> <span class="n">Stock</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">var</span> <span class="nl">code</span><span class="p">:</span> <span class="n">String</span><span class="o">?</span>
</span><span class='line'>    <span class="k">var</span> <span class="nl">price</span><span class="p">:</span> <span class="n">Double</span><span class="o">?</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">func</span> <span class="n">findStockCode</span><span class="p">(</span><span class="nl">company</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Stock</span><span class="o">?</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">company</span> <span class="o">==</span> <span class="s">&quot;Apple&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">let</span> <span class="nl">aapl</span><span class="p">:</span> <span class="n">Stock</span> <span class="o">=</span> <span class="n">Stock</span><span class="p">()</span>
</span><span class='line'>        <span class="n">aapl</span><span class="p">.</span><span class="n">code</span> <span class="o">=</span> <span class="s">&quot;AAPL&quot;</span>
</span><span class='line'>        <span class="n">aapl</span><span class="p">.</span><span class="n">price</span> <span class="o">=</span> <span class="mf">90.32</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">aapl</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">company</span> <span class="o">==</span> <span class="s">&quot;Google&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">let</span> <span class="nl">goog</span><span class="p">:</span> <span class="n">Stock</span> <span class="o">=</span> <span class="n">Stock</span><span class="p">()</span>
</span><span class='line'>        <span class="n">goog</span><span class="p">.</span><span class="n">code</span> <span class="o">=</span> <span class="s">&quot;GOOG&quot;</span>
</span><span class='line'>        <span class="n">goog</span><span class="p">.</span><span class="n">price</span> <span class="o">=</span> <span class="mf">556.36</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">goog</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nb">nil</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="k">let</span> <span class="n">sharePrice</span> <span class="o">=</span> <span class="n">findStockCode</span><span class="p">(</span><span class="s">&quot;Apple&quot;</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="n">price</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">let</span> <span class="n">totalCost</span> <span class="o">=</span> <span class="n">sharePrice</span> <span class="o">*</span> <span class="mi">100</span>
</span><span class='line'>    <span class="n">print</span><span class="p">(</span><span class="n">totalCost</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>在这段代码中，进行了2次nil检查，一次是判断findStockCode(&ldquo;Apple&rdquo;)是否为nil，一次是判断findStockCode(&ldquo;Apple&rdquo;).price是否为nil。使用optional chaining，可以简化nil检查写法。</p>

<h3>参考文献</h3>

<p><a href="https://www.appcoda.com/beginners-guide-optionals-swift/">A Beginner’s Guide to Optionals in Swift</a><br/>
<a href="http://blog.teamtreehouse.com/understanding-optionals-swift">Understanding Optionals in Swift</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[模仿UIAlertView的一个Rotatable Overlay View — RTOverlayWindow]]></title>
    <link href="http://iandai.github.io/blog/2015/10/09/mo-fang-uialertviewde-%5B%3F%5D-ge-rotatable-overlay-view-rtoverlaywindow/"/>
    <updated>2015-10-09T15:37:41+02:00</updated>
    <id>http://iandai.github.io/blog/2015/10/09/mo-fang-uialertviewde-[?]-ge-rotatable-overlay-view-rtoverlaywindow</id>
    <content type="html"><![CDATA[<p>在写customised alert view的时候，遇到了一些问题，于是写了RTOverlayWindow。</p>

<p>最简单添加OverlayView的方法（苹果官方并不推荐使用这种方法），就是</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="bp">UIWindow</span> <span class="o">*</span><span class="n">keyWindow</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UIApplication</span> <span class="n">sharedApplication</span><span class="p">]</span> <span class="n">keyWindow</span><span class="p">];</span>
</span><span class='line'><span class="p">[</span><span class="n">keyWindow</span> <span class="nl">addSubview</span><span class="p">:</span><span class="n">someCustomizedView</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>使用上面的方法，添加的<code>someCustomizedView</code>无法自动旋转。
对无法自动旋转，最合理的解决方法，是把这个view放到一个UIViewController里面管理。</p>

<p>但是，还是希望有一种简单的方法，和使用UIAlertView一样，只是单纯的添加一个简单的view，就可以方便的使用。<br/>
于是研究了一下UIAlertView的实现。</p>

<p>在iOS7中，在界面有UIAlertView弹出的状态下，使用<code>po [[UIWindow keyWindow] recursiveDescription]</code>可以看到当前UIAlertView的view结构。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">&lt;</span><span class="nl">_UIModalItemHostingWindow</span><span class="p">:</span> <span class="mh">0x7af46ee0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">320</span> <span class="mi">480</span><span class="p">);</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7af473e0</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">UIWindowLayer</span><span class="p">:</span> <span class="mh">0x7af47060</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7af46dd0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">320</span> <span class="mi">480</span><span class="p">);</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7af46d60</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7af49800</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">320</span> <span class="mi">480</span><span class="p">);</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7af49860</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7b2561f0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">320</span> <span class="mi">480</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b256250</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIModalItemRepresentationView</span><span class="p">:</span> <span class="mh">0x7b255d90</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">25</span> <span class="mi">178</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">124</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b255ea0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIModalItemAlertBackgroundView</span><span class="p">:</span> <span class="mh">0x7af30f80</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">124</span><span class="p">);</span> <span class="n">animations</span> <span class="o">=</span> <span class="p">{</span> <span class="o">&lt;</span><span class="nl">_UIParallaxMotionEffect</span><span class="p">:</span> <span class="mh">0x7af4c470</span><span class="o">&gt;=&lt;</span><span class="nl">CAAnimationGroup</span><span class="p">:</span> <span class="mh">0x7b25e510</span><span class="o">&gt;</span><span class="p">;</span> <span class="p">};</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7af312e0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIBackdropView</span><span class="p">:</span> <span class="mh">0x7af3de20</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">124</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">_UIBackdropViewLayer</span><span class="p">:</span> <span class="mh">0x7af4a290</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIBackdropEffectView</span><span class="p">:</span> <span class="mh">0x7af4ab30</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">124</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CABackdropLayer</span><span class="p">:</span> <span class="mh">0x7af4ae50</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7af4b150</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">124</span><span class="p">);</span> <span class="n">hidden</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7af4b5c0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7af3b830</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">124</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7af47020</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIModalItemAlertContentView</span><span class="p">:</span> <span class="mh">0x7af45b50</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">124</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">animations</span> <span class="o">=</span> <span class="p">{</span> <span class="o">&lt;</span><span class="nl">_UIParallaxMotionEffect</span><span class="p">:</span> <span class="mh">0x7af4c470</span><span class="o">&gt;=&lt;</span><span class="nl">CAAnimationGroup</span><span class="p">:</span> <span class="mh">0x7b25ec90</span><span class="o">&gt;</span><span class="p">;</span> <span class="p">};</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7af45cf0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UITableView</span><span class="p">:</span> <span class="mh">0x7cb96000</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">135</span> <span class="mi">80</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7b236eb0</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b236960</span><span class="o">&gt;</span><span class="p">;</span> <span class="nl">contentOffset</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UITableViewWrapperView</span><span class="p">:</span> <span class="mh">0x7b2378f0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b237a00</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIModalItemTableViewCell</span><span class="p">:</span> <span class="mh">0x7b2648c0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">text</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">OK</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b256010</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UITableViewCellScrollView</span><span class="p">:</span> <span class="mh">0x7b264a60</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7b237d50</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b2604b0</span><span class="o">&gt;</span><span class="p">;</span> <span class="nl">contentOffset</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UITableViewCellContentView</span><span class="p">:</span> <span class="mh">0x7b2520e0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mf">43.5</span><span class="p">);</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7b261de0</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b261220</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UILabel</span><span class="p">:</span> <span class="mh">0x7b264d30</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">105</span> <span class="mf">43.5</span><span class="p">);</span> <span class="n">text</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">OK</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b255ed0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7b2577b0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mf">131.5</span> <span class="mi">37</span><span class="p">;</span> <span class="mf">3.5</span> <span class="mi">7</span><span class="p">);</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">LM</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b257880</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7b2571d0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span> <span class="mf">40.5</span><span class="p">;</span> <span class="mi">7</span> <span class="mf">3.5</span><span class="p">);</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">TM</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b257420</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIScrollView</span><span class="p">:</span> <span class="mh">0x7b238430</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">61</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7b2389a0</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b238680</span><span class="o">&gt;</span><span class="p">;</span> <span class="nl">contentOffset</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UILabel</span><span class="p">:</span> <span class="mh">0x7b2337a0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span> <span class="mi">19</span><span class="p">;</span> <span class="mi">240</span> <span class="mi">21</span><span class="p">);</span> <span class="n">text</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">title</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b233850</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UILabel</span><span class="p">:</span> <span class="mh">0x7b2340a0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span> <span class="mi">44</span><span class="p">;</span> <span class="mi">240</span> <span class="mi">17</span><span class="p">);</span> <span class="n">text</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">message</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b233950</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7b258bd0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mf">57.5</span><span class="p">;</span> <span class="mi">270</span> <span class="mf">3.5</span><span class="p">);</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">TM</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b258ca0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7b258da0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mf">266.5</span> <span class="mi">0</span><span class="p">;</span> <span class="mf">3.5</span> <span class="mi">61</span><span class="p">);</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">LM</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b258e70</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7b2541d0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mf">79.5</span><span class="p">;</span> <span class="mi">270</span> <span class="mf">0.5</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b254230</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UITableView</span><span class="p">:</span> <span class="mh">0x7cbc7400</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">80</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7b254320</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b2542b0</span><span class="o">&gt;</span><span class="p">;</span> <span class="nl">contentOffset</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UITableViewWrapperView</span><span class="p">:</span> <span class="mh">0x7b254620</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b254710</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIModalItemTableViewCell</span><span class="p">:</span> <span class="mh">0x7b25fb20</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">text</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">cancel</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b25fe00</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UITableViewCellScrollView</span><span class="p">:</span> <span class="mh">0x7b2600c0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7b236cf0</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b260330</span><span class="o">&gt;</span><span class="p">;</span> <span class="nl">contentOffset</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UITableViewCellContentView</span><span class="p">:</span> <span class="mh">0x7b2368e0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mf">43.5</span><span class="p">);</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7b256cd0</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b237f90</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UILabel</span><span class="p">:</span> <span class="mh">0x7b237a30</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">105</span> <span class="mf">43.5</span><span class="p">);</span> <span class="n">text</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">cancel</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b25b8a0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7b259200</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mf">131.5</span> <span class="mi">37</span><span class="p">;</span> <span class="mf">3.5</span> <span class="mi">7</span><span class="p">);</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">LM</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b2592d0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7b259020</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">128</span> <span class="mf">40.5</span><span class="p">;</span> <span class="mi">7</span> <span class="mf">3.5</span><span class="p">);</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">TM</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b2590f0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7b254820</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">135</span> <span class="mi">80</span><span class="p">;</span> <span class="mf">0.5</span> <span class="mi">44</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7b254880</span><span class="o">&gt;&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>在iOS8中UIVAlertView结构如下。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="o">&lt;</span><span class="nl">_UIAlertControllerShimPresenterWindow</span><span class="p">:</span> <span class="mh">0x7bbbfaa0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">768</span> <span class="mi">1024</span><span class="p">);</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7bbc0600</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">UIWindowLayer</span><span class="p">:</span> <span class="mh">0x7bbbfcf0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7bd727b0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">768</span> <span class="mi">1024</span><span class="p">);</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bd72820</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UITransitionView</span><span class="p">:</span> <span class="mh">0x7a7bcb20</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">768</span> <span class="mi">1024</span><span class="p">);</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a7bccd0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a68fd90</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">768</span> <span class="mi">1024</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a68fe00</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIKeyboardLayoutAlignmentView</span><span class="p">:</span> <span class="mh">0x7a68fab0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">1024</span><span class="p">;</span> <span class="mi">768</span> <span class="mi">0</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a68fc60</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a68f8e0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">768</span> <span class="mi">1024</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a68f890</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIAlertControllerView</span><span class="p">:</span> <span class="mh">0x7a695f70</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">249</span> <span class="mi">451</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">122</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a6961e0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a696350</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">122</span><span class="p">);</span> <span class="n">animations</span> <span class="o">=</span> <span class="p">{</span> <span class="o">&lt;</span><span class="nl">_UIParallaxMotionEffect</span><span class="p">:</span> <span class="mh">0x7a792160</span><span class="o">&gt;=&lt;</span><span class="nl">CAAnimationGroup</span><span class="p">:</span> <span class="mh">0x7a7b2380</span><span class="o">&gt;</span><span class="p">;</span> <span class="p">};</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a6963c0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIDimmingKnockoutBackdropView</span><span class="p">:</span> <span class="mh">0x7a69fd90</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">122</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a689fa0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a68a490</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">122</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a687850</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIBackdropView</span><span class="p">:</span> <span class="mh">0x7a69fe00</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">122</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">_UIBackdropViewLayer</span><span class="p">:</span> <span class="mh">0x7a692a40</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a694d00</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">122</span><span class="p">);</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">W</span><span class="o">+</span><span class="n">H</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a6746d0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a696410</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">122</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a696480</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a6964d0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">122</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a696540</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIAlertControllerShadowedScrollView</span><span class="p">:</span> <span class="mh">0x7a6966b0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">78</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7a696e60</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a6969c0</span><span class="o">&gt;</span><span class="p">;</span> <span class="nl">contentOffset</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span> <span class="nl">contentSize</span><span class="p">:</span> <span class="p">{</span><span class="mi">270</span><span class="p">,</span> <span class="mi">78</span><span class="p">}</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a6975c0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">78</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a697630</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UILabel</span><span class="p">:</span> <span class="mh">0x7a698580</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span> <span class="mi">20</span><span class="p">;</span> <span class="mi">238</span> <span class="mi">21</span><span class="p">);</span> <span class="n">text</span> <span class="o">=</span> <span class="err">&#39;</span><span class="mi">11</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">_UILabelLayer</span><span class="p">:</span> <span class="mh">0x7a698240</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UILabel</span><span class="p">:</span> <span class="mh">0x7a69ab30</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span> <span class="mi">42</span><span class="p">;</span> <span class="mi">238</span> <span class="mi">16</span><span class="p">);</span> <span class="n">text</span> <span class="o">=</span> <span class="err">&#39;</span><span class="mi">22</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">_UILabelLayer</span><span class="p">:</span> <span class="mh">0x7a69abf0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a69ad70</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">135</span> <span class="o">-</span><span class="mi">451</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a69ade0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7a787b60</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">75</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">3</span><span class="p">);</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">TM</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a787e70</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7a788610</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">267</span> <span class="mi">902</span><span class="p">;</span> <span class="mi">3</span> <span class="mi">78</span><span class="p">);</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">LM</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a788690</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UICollectionView</span><span class="p">:</span> <span class="mh">0x7a984a00</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">78</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">44</span><span class="p">);</span> <span class="n">clipsToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7a69bd70</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a69bad0</span><span class="o">&gt;</span><span class="p">;</span> <span class="nl">contentOffset</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span> <span class="nl">contentSize</span><span class="p">:</span> <span class="p">{</span><span class="mi">270</span><span class="p">,</span> <span class="mi">44</span><span class="p">}</span><span class="o">&gt;</span> <span class="n">collection</span> <span class="n">view</span> <span class="nl">layout</span><span class="p">:</span> <span class="o">&lt;</span><span class="nl">_UIAlertControllerCollectionViewFlowLayout</span><span class="p">:</span> <span class="mh">0x7a69b1d0</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIAlertControllerCollectionViewCell</span><span class="p">:</span> <span class="mh">0x7bbbaec0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbbd730</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7bbbc4a0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7bbb11b0</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbc2110</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIAlertControllerActionView</span><span class="p">:</span> <span class="mh">0x7bbbc100</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">Action</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">UIAlertAction</span><span class="p">:</span> <span class="mh">0x7bbbf640</span> <span class="n">Title</span> <span class="o">=</span> <span class="s">&quot;cancel&quot;</span> <span class="n">Descriptive</span> <span class="o">=</span> <span class="s">&quot;(null)&quot;</span> <span class="n">Image</span> <span class="o">=</span> <span class="mh">0x0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIBlendingHighlightView</span><span class="p">:</span> <span class="mh">0x7bbc5640</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">hidden</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbc5810</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7bbc56e0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbc4dd0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7bbc5790</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbc6580</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7bbc28e0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">111</span> <span class="mi">0</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bb68f30</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UILabel</span><span class="p">:</span> <span class="mh">0x7bbbc1c0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">12</span><span class="p">;</span> <span class="mi">111</span> <span class="mi">21</span><span class="p">);</span> <span class="n">text</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">cancel</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">_UILabelLayer</span><span class="p">:</span> <span class="mh">0x7bbbd3e0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UILabel</span><span class="p">:</span> <span class="mh">0x7bbbc280</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">12</span> <span class="mi">22</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">);</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">_UILabelLayer</span><span class="p">:</span> <span class="mh">0x7bbc1c50</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UILabelContentLayer</span><span class="p">:</span> <span class="mh">0x7a7b5620</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">layer</span><span class="p">)</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7bbbc340</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span> <span class="mi">22</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">);</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbbc3c0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7bbbfe30</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">109</span> <span class="mi">15</span><span class="p">;</span> <span class="mi">14</span> <span class="mi">14</span><span class="p">);</span> <span class="n">hidden</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbc2d30</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIAlertControllerCollectionViewCell</span><span class="p">:</span> <span class="mh">0x7bbcd6c0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">135</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbcd2a0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7bbcd760</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">gestureRecognizers</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">NSArray</span><span class="p">:</span> <span class="mh">0x7bbcd950</span><span class="o">&gt;</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbcd7d0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIAlertControllerActionView</span><span class="p">:</span> <span class="mh">0x7bbcd980</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">Action</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">UIAlertAction</span><span class="p">:</span> <span class="mh">0x7bbbf7c0</span> <span class="n">Title</span> <span class="o">=</span> <span class="s">&quot;OK&quot;</span> <span class="n">Descriptive</span> <span class="o">=</span> <span class="s">&quot;(null)&quot;</span> <span class="n">Image</span> <span class="o">=</span> <span class="mh">0x0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIBlendingHighlightView</span><span class="p">:</span> <span class="mh">0x7bbd0550</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">hidden</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbd1e30</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7bbd05f0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbd0060</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7bbd06a0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">135</span> <span class="mi">44</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbd2bf0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7bbcda70</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">111</span> <span class="mi">0</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbcdae0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UILabel</span><span class="p">:</span> <span class="mh">0x7bbcdb10</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">12</span><span class="p">;</span> <span class="mi">111</span> <span class="mi">21</span><span class="p">);</span> <span class="n">text</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">OK</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">_UILabelLayer</span><span class="p">:</span> <span class="mh">0x7bbcdbd0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UILabel</span><span class="p">:</span> <span class="mh">0x7bbcdd20</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">12</span> <span class="mi">22</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">);</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">_UILabelLayer</span><span class="p">:</span> <span class="mh">0x7bbcdde0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UILabelContentLayer</span><span class="p">:</span> <span class="mh">0x7a7b50d0</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">layer</span><span class="p">)</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7bbcdf30</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span> <span class="mi">22</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">);</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbcdfb0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7bbcdfe0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">109</span> <span class="mi">15</span><span class="p">;</span> <span class="mi">14</span> <span class="mi">14</span><span class="p">);</span> <span class="n">hidden</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7bbce060</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIAlertControllerBlendingSeparatorView</span><span class="p">:</span> <span class="mh">0x7a7739b0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">1</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a78d6b0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIBlendingHighlightView</span><span class="p">:</span> <span class="mh">0x7a774ac0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">1</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a7926e0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a77f430</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">1</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a792760</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a785440</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">1</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a7927c0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIAlertControllerBlendingSeparatorView</span><span class="p">:</span> <span class="mh">0x7a780ab0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">135</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">1</span> <span class="mi">43</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a79d5a0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">_UIBlendingHighlightView</span><span class="p">:</span> <span class="mh">0x7a78c490</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">1</span> <span class="mi">43</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a7928e0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a7beba0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">1</span> <span class="mi">43</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a792960</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIView</span><span class="p">:</span> <span class="mh">0x7a772d20</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">1</span> <span class="mi">43</span><span class="p">);</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a7929e0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7a789f20</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="mi">41</span><span class="p">;</span> <span class="mi">270</span> <span class="mi">3</span><span class="p">);</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">TM</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a789fa0</span><span class="o">&gt;&gt;</span>
</span><span class='line'>   <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span>    <span class="o">|</span> <span class="o">&lt;</span><span class="nl">UIImageView</span><span class="p">:</span> <span class="mh">0x7a78a3e0</span><span class="p">;</span> <span class="n">frame</span> <span class="o">=</span> <span class="p">(</span><span class="mi">267</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">3</span> <span class="mi">44</span><span class="p">);</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">opaque</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">autoresize</span> <span class="o">=</span> <span class="n">LM</span><span class="p">;</span> <span class="n">userInteractionEnabled</span> <span class="o">=</span> <span class="nb">NO</span><span class="p">;</span> <span class="n">layer</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nl">CALayer</span><span class="p">:</span> <span class="mh">0x7a78a460</span><span class="o">&gt;&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>可以看到，虽然UIAlertView在iOS7和iOS8中实现方法不同，但都是新建了一个UIWindow，并设为keyWindow。<br/>
模仿UIAlertView的方式，做了<a href="https://github.com/iandai/RTOverlayWindow">RTOverlayWindow</a>。<br/>
需要注意的是，使用多层UIWindow也是苹果所不推荐的方法，不过有时候在代码结构本身不合理的情况下，也是一种不错的方法。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS App如何正确的要求用户同意获取系统权限（摘要）]]></title>
    <link href="http://iandai.github.io/blog/2015/09/24/ios-appru-he-zheng-que-de-yao-qiu-yong-hu-tong-yi-huo-qu-xi-tong-quan-xian-(zhai-yao-)/"/>
    <updated>2015-09-24T11:30:22+02:00</updated>
    <id>http://iandai.github.io/blog/2015/09/24/ios-appru-he-zheng-que-de-yao-qiu-yong-hu-tong-yi-huo-qu-xi-tong-quan-xian-(zhai-yao-)</id>
    <content type="html"><![CDATA[<h2>iOS App如何正确的要求用户同意获取系统权限（摘要）</h2>

<ul>
<li>App下载后，第一次初始化的时候，弹出对话框，要求获取系统权限。成功率只有30%－40%。这种方法不推荐。</li>
<li>在给用户介绍App功能的界面，解释为什么需要获取某一项系统权限，并弹出对话框。成功率有40% - 66%。这种方法也不推荐。</li>
<li>在用户进行某项操作，必须使用到某一项系统权限的时候，弹出App自定义的对话框，解释为何需要获取某一项系统权限。如果用户点击同意，那么再弹出系统的权限获取对话框。如果用户点击不同意，那么App就不执行该功能，告诉用户要做的操作失败。利用这种方法，有时候成功率可以达到100%。</li>
</ul>


<h4>参考文献</h4>

<p><a href="http://techcrunch.com/2014/04/04/the-right-way-to-ask-users-for-ios-permissions/">The Right Way To Ask Users For iOS Permissions</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS在删除App的情况下，仍然会记忆App Camera访问权限的reset方法]]></title>
    <link href="http://iandai.github.io/blog/2015/09/24/iozai-shan-chu-appde-qing-kuang-xia-,reng-ran-hui-ji-yi-app-camerafang-wen-quan-xian-de-resetfang-fa/"/>
    <updated>2015-09-24T10:50:50+02:00</updated>
    <id>http://iandai.github.io/blog/2015/09/24/iozai-shan-chu-appde-qing-kuang-xia-,reng-ran-hui-ji-yi-app-camerafang-wen-quan-xian-de-resetfang-fa</id>
    <content type="html"><![CDATA[<h2>重设App相机访问权限方法</h2>

<ul>
<li>iOS在删除App的情况下，仍然会记忆App camera访问权限1天</li>
<li>重设方法一：调整系统时间。</li>
<li>重设方法二：修改App的bundle id。</li>
<li>重设方法三：重设所有App的位置和隐私。Settings -> General -> Reset -> Rest Location &amp; Privacy</li>
</ul>


<h4>参考文献</h4>

<p><a href="http://stackoverflow.com/questions/27726354/ipad-remembering-camera-permissions-after-delete-how-to-clear">重设相机访问权限</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[高性能添加图片圆角方法原理：cornerRadius，layer.shouldRasterize，layer.setShadowPath和透明图片]]></title>
    <link href="http://iandai.github.io/blog/2015/09/21/gao-xing-neng-tian-jia-tu-pian-yuan-jiao-fang-fa-bi-jiao-:layer-dot-shouldrasterize,layer-dot-setshadowpathhe-tou-ming-tu-pian/"/>
    <updated>2015-09-21T14:07:34+02:00</updated>
    <id>http://iandai.github.io/blog/2015/09/21/gao-xing-neng-tian-jia-tu-pian-yuan-jiao-fang-fa-bi-jiao-:layer-dot-shouldrasterize,layer-dot-setshadowpathhe-tou-ming-tu-pian</id>
    <content type="html"><![CDATA[<h2>在layer上添加cornerRadius原理</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="bp">UIImage</span> <span class="o">*</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIImage</span> <span class="nl">imageNamed</span><span class="p">:</span><span class="s">@&quot;sample&quot;</span><span class="p">];</span>   <span class="c1">//顺便提一句，imageNamed这个方法会cache image。</span>
</span><span class='line'><span class="bp">UIImageView</span> <span class="o">*</span><span class="n">imgView</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UIImageView</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithImage</span><span class="p">:</span><span class="n">image</span><span class="p">];</span>
</span><span class='line'><span class="n">imgView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">masksToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'><span class="n">imgView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">cornerRadius</span> <span class="o">=</span> <span class="mf">0.5f</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>调用cornerRadius的时候，系统会做什么？
设置cornerRadius，会在layer的background上面绘制圆角。默认情况下，这并不会应用到layer的contents属性上的图片（每个layer中contents属性接受一个CGImage的对象）。
设置masksToBounds属性为YES，并且设置cornerRadius的值的话，Core Animation会创建一个包含圆角效果的蒙板（mask）。 这使得layer的contents属性中的图片在蒙板作用下，产生圆角效果[1]。</p></li>
<li><p>为什么在uitableview或者uicollectionview中滚动的时候，给图片添加圆角直接用cornerRadius性能不好？
当layer的属性cornerRadius和maskToBounds一起使用时，会触发离屏渲染（Offscreen rendering）。</p></li>
<li><p>离屏渲染Offscreen rendering是什么呢？
Offscreen rendring指的是在图像在绘制到当前屏幕前，需要先渲染到一个Offscreen context，之后才绘制到屏幕。当Offscreen rendering频繁发生的时候，就会降低性能[2]。
－－－
这里提到的offscreen rendering主要讲的是通过GPU执行的offscreen,事实上还有的offscreen rendering是通过CPU来执行的（例如使用Core Graphics, drawRect）。其它类似cornerRadios, masks, shadows等触发的offscreen是基于GPU的。［4］
－－－</p></li>
<li><p>离屏渲染Offscreen rendering的可能误解。
Offscreen rendering
Offscreen rendering is drawing, that cannot be done using hardware acceleration (GPU) and should be performed on the CPU instead.
At the low level this looks like that: during rendering of the layer that requires the offscreen rendering, the GPU stops the rendering pipeline and passes control to the CPU. In its turn, the CPU performs all the necessary operations (e.g. your fancy stuff in drawRect:) and returns control to the GPU with the already rendered layer. GPU renders it and the rendering pipeline keeps going.
<a href="https://yalantis.com/blog/mastering-uikit-performance/">https://yalantis.com/blog/mastering-uikit-performance/</a>
以上对Offscreen rendering解释是片面的。</p></li>
<li><p>为什么cornerRadius和maskToBounds一起使用时，会触发离屏渲染？
cornerRadius和maskToBounds一起使用时，Core Animation会创建一个包含圆角效果的蒙板（mask）。
Offscreen rendering会在layer的各种属性结合，使得layer不能直接绘制到屏幕上，需要进行pre-compositing的时候，会触发离屏渲染。
（原文：Offscreen rendering is invoked whenever the combinnation of layer propertyies that have been specified mean that the layer cannot be drawn directly to the screen without pre-compositing.）［3］</p></li>
</ul>


<h2>可能提高性能的方法一：光栅化layer.shouldRasterize</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="bp">UIImage</span> <span class="o">*</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIImage</span> <span class="nl">imageNamed</span><span class="p">:</span><span class="s">@&quot;sample&quot;</span><span class="p">];</span>
</span><span class='line'><span class="bp">UIImageView</span> <span class="o">*</span><span class="n">imgView</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UIImageView</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithImage</span><span class="p">:</span><span class="n">image</span><span class="p">];</span>
</span><span class='line'><span class="n">imgView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">masksToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'><span class="n">imgView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">cornerRadius</span> <span class="o">=</span> <span class="mf">0.5f</span><span class="p">;</span>
</span><span class='line'><span class="n">imgView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">shouldRasterize</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>什么是光栅化（Rasterisation）？
Rasterisation (or rasterization) is the task of taking an image described in a vector graphics format (shapes) and converting it into a raster image (pixels or dots) for output on a video display or printer, or for storage in a bitmap file format.</p></li>
<li><p>为什么layer.shouldRasterize可能提高性能？
开启shouldRasterize后,layer会被光栅化为bitmap,layer的包含圆角的mask效果也会被保存到bitmap中。
要注意的是，更新已光栅化的layer，会造成大量的offscreen渲染。</p></li>
</ul>


<h2>可能提高性能的方法二：设置layer.shadowPath属性</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="bp">UIImage</span> <span class="o">*</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIImage</span> <span class="nl">imageNamed</span><span class="p">:</span><span class="s">@&quot;sample&quot;</span><span class="p">];</span>
</span><span class='line'><span class="bp">UIImageView</span> <span class="o">*</span><span class="n">imgView</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">UIImageView</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithImage</span><span class="p">:</span><span class="n">image</span><span class="p">];</span>
</span><span class='line'><span class="n">imgView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">masksToBounds</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
</span><span class='line'><span class="n">imgView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">cornerRadius</span> <span class="o">=</span> <span class="mf">0.5f</span><span class="p">;</span>
</span><span class='line'><span class="n">imgView</span><span class="p">.</span><span class="n">layer</span><span class="p">.</span><span class="n">shadowPath</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIBezierPath</span> <span class="nl">bezierPathWithRect</span><span class="p">:</span><span class="n">imgView</span><span class="p">.</span><span class="n">bounds</span><span class="p">].</span><span class="bp">CGPath</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>layer的shadowPath的理解
layer会创建一个圆角的shadowPath，并且会cache这个shadowPath，避免多次重绘。</li>
</ul>


<h2>可能提高性能的方法三：添加自带圆角中间透明的图片</h2>

<ul>
<li>这会cache圆角图片，但是在blending的时候，有透明的部分，会降低部分性能。
（利用一张中间为透明圆形的图片来进行遮盖,虽然会引起blending,但性能仍然高于offerScreen。） 来源：WWDC心得与延伸</li>
</ul>


<h2>可能提高性能的方法四: myView.layer.drawAsynchronously = YES</h2>

<p>当你设置 drawsAsynchronously 为 YES 时，发生了什么？你的 -drawRect:/-drawInContext:方法仍然会被在主线程上调用。  但是所有调用 Core Graphics 的操作都不会被执行。取而代之的是，绘制命令被推迟，并且在后台线程中异步执行。<br/>
这种方式就是先记录绘图命令，然后在后台线程中重现。为了这个过程的顺利进行，更多的工作需要被做，更多的内存需要被申请。但是主队列中的一些工作便被移出来了(大概意思就是让我们把一些能在后台实现的工作放到后台实现，让主线程更顺畅)。<br/>
对于昂贵的绘图方法，这是最有可能提升性能的，但对于那些绘图方法来说，也不会节省太多资源。</p>

<h2>整个绘制过程</h2>

<p>当你滚动整个屏幕的时候，数以百万计的颜色单元必须以每秒60次的速度刷新，这是一个很大的工作量。</p>

<p>第一步：
CPU 开始运行你的程序。你可能会让 CPU 从 bundle 加载一张 PNG 的图片并且解压它。
这所有的事情都在 CPU 上进行。然后当你需要显示解压缩后的图片时，它需要以某种方式上传到 GPU。</p>

<p>如果一个 CALayer 的子类实现了 -drawInContext: 或者它的代理，类似于 -drawLayer:inContest:, Core Animation 将会为这个图层申请一个后备存储，用来保存那些方法绘制进来的位图。那些方法内的代码将会运行在 CPU 上，结果将会被上传到 GPU。</p>

<p>第二步：
将数据传输到 GPU 上。为了让 GPU 访问数据，需要将数据从 RAM 移动到 VRAM 上。这就是提及到的上传数据到 GPU。这看起来貌似微不足道，但是一些大型的纹理却会非常耗时。</p>

<p>第三步：
GPU 需要将每一个 frame 的纹理(位图)合成在一起(一秒60次)。
每一个纹理会占用 VRAM(video RAM)，所以需要给 GPU 同时保持纹理的数量做一个限制。
GPU 在合成方面非常高效，但是某些合成任务却比其他更复杂，并且 GPU在 16.7ms(1/60s)内能做的工作也是有限的。</p>

<h2>软件绘图</h2>

<p>在iOS中，软件绘图通常是由Core Graphics框架完成来完成。<br/>
相比Core Animation和OpenGL，Core Graphics要慢了不少。<br/>
软件绘图不仅效率低，还会消耗可观的内存。<br/>
一旦你实现了CALayerDelegate协议中的-drawLayer:inContext:方法或者UIView中的-drawRect:方法（其实就是前者的包装方法），图层就创建了一个绘制上下文，这个上下文需要的大小的内存可从这个算式得出：图层宽<em>图层高</em>4字节，宽高的单位均为像素。<br/>
软件绘图的代价昂贵，除非绝对必要，你应该避免重绘你的视图。提高绘制性能的秘诀就在于尽量避免去绘制。</p>

<h2>总结</h2>

<ul>
<li>测量、测试、迭代。为了有好的性能，需要在不同的设备上，平衡各种利弊，不断测试和改进。</li>
</ul>


<h3>参考文献</h3>

<p><a href="https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CALayer_class/#//apple_ref/occ/instp/CALayer/cornerRadius">Apple Reference cornerRadius</a>
<a href="https://github.com/AttackOnDobby/iOS-Core-Animation-Advanced-Techniques">From iOS Core Animation: Advanced Techniques</a>
<a href="http://www.cocoachina.com/ios/20150429/11712.html">WWDC心得与延伸:iOS图形性能</a>
<a href="http://adcdownload.apple.com/wwdc_2012/wwdc_2012_session_pdfs/session_238__ios_app_performance_graphics_and_animations.pdf">WWDC:ios_app_performance_graphics_and_animations</a>
<a href="https://www.objc.io/issues/3-views/moving-pixels-onto-the-screen/">Getting Pixels onto the Screen</a>
<a href="http://stackoverflow.com/questions/13158796/what-triggers-offscreen-rendering-blending-and-layoutsubviews-in-ios">What triggers offscreen rendering, blending and layoutSubviews in iOS</a>
<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/CoreAnimation_guide/ImprovingAnimationPerformance/ImprovingAnimationPerformance.html">Core Animation Programming Guide：Improving Animation Performance</a>
<a href="https://robots.thoughtbot.com/designing-for-ios-graphics-performance">Designing for iOS: Graphics &amp; Performance</a>
<a href="http://www.taofengping.com/2013/05/18/ios_offscreen_analysis/#.VZZkuhOqpBc">深入的offscreen render分析：iOS离屏绘制的性能和机制分析by Apple UIKit team member</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Useful iOS Debug Tricks]]></title>
    <link href="http://iandai.github.io/blog/2015/09/20/useful-ios-debug-tricks/"/>
    <updated>2015-09-20T09:08:33+02:00</updated>
    <id>http://iandai.github.io/blog/2015/09/20/useful-ios-debug-tricks</id>
    <content type="html"><![CDATA[<h3>Crash Without Detailed Info</h3>

<h4>解决方法：</h4>

<ul>
<li>添加All Exception Breakpoint
在Breakpoint navigator，点+号，选择Add Exception Breakpoint，在Option选项选择默认的All。这样每次crash的时候仍然可以看到线程栈，调试起来就会方便很多，不用猜测到底哪里出了问题。</li>
<li>在lldb里面输入<code>po $arg1</code>
有时候crash的时候，线程栈是在UIApplicationMain，或者Main之类的地方，看不出来真正的crash的原因。这时候输入<code>po $arg1</code>有时候可以看到真正的crash原因。（不理解具体原理是什么, somehow it works）。</li>
</ul>


<h3>Debug after force quit app</h3>

<h4>解决方法：</h4>

<ul>
<li>Attach to Process
有时候需要Debug用户force quit一个App之后，在重新打开App之后的表现。可以在Debug的Attach to Process中,重新把App和Xcode连接起来，继续debug。</li>
</ul>


<h3>Debug View</h3>

<h4>解决方法：</h4>

<ul>
<li>在lldb中<code>po [[UIWindow keyWindow] recursiveDescription]</code></li>
<li>按cmd + 6进入Debug navigator，在该栏右上角的Process View option按钮中选择View UI Hierarchy。或者点击Debug View Hierarchy按钮。</li>
</ul>


<h3>Simulator shortcuts</h3>

<ul>
<li>回到Home：Command-Shift-H</li>
<li>关闭App： Command-Shift-H按两次</li>
<li>关闭网络： 关闭系统的网络</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Growth Tactics Example]]></title>
    <link href="http://iandai.github.io/blog/2015/08/12/growth-tatics/"/>
    <updated>2015-08-12T10:59:19+02:00</updated>
    <id>http://iandai.github.io/blog/2015/08/12/growth-tatics</id>
    <content type="html"><![CDATA[<ol>
<li>Jet.com用10万股票吸引人，帮助自己获得内测用户。带来最多的内测用户的人，可以获得10万股票，按照融资估值，约等于2000万美元。
第一Jet获得了注册用户，除了获得第一的人，其他人也在比赛中带来了注册用户
第二Jet付出的是股票，可以节约现金
第三Jet根据这个，做了一个事件营销，让自己变得有名
<a href="http://fusion.net/story/54990/guy-got-rich-using-jet/">http://fusion.net/story/54990/guy-got-rich-using-jet/</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The Hamburger Menu Doesn't Work]]></title>
    <link href="http://iandai.github.io/blog/2015/08/11/the-hamburger-menu-doesnt-work/"/>
    <updated>2015-08-11T12:23:06+02:00</updated>
    <id>http://iandai.github.io/blog/2015/08/11/the-hamburger-menu-doesnt-work</id>
    <content type="html"><![CDATA[<p>Source:<br/>
<a href="http://deep.design/the-hamburger-menu/">http://deep.design/the-hamburger-menu/</a></p>

<p>Summary:</p>

<p>Facebook和New York Times也同样使用过Hambuerger Menu，但是结果显示不利于user engagement，后来都换回了tab。
作者所给出的理由，最重要的一点是，用户使用app和网页的方式，是看那些会令自己感兴趣的文字，然后到处试一试。而hanburger menu不显得有任何有趣的地方。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CLLocationManager Notes]]></title>
    <link href="http://iandai.github.io/blog/2015/07/09/cllocationmanager-notes/"/>
    <updated>2015-07-09T12:52:09+02:00</updated>
    <id>http://iandai.github.io/blog/2015/07/09/cllocationmanager-notes</id>
    <content type="html"><![CDATA[<ol>
<li><p>-(void)locationManager:(CLLocationManager <em>)manager didUpdateLocations:(NSArray </em>)locations
声名locationManager变量为局部变量会导致delegate不会被call，因为locationManager变量被释放了。</p></li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Create an instance of the CLLocationManager class and store a strong reference to it somewhere in your app.</span></code></pre></td></tr></table></div></figure>


<ol>
<li>提高location结果精度，并且在使用结束后停止updatelocation.
参考apple官方LocateMe sample：<a href="https://developer.apple.com/library/ios/samplecode/LocateMe/Introduction/Intro.html">https://developer.apple.com/library/ios/samplecode/LocateMe/Introduction/Intro.html</a></li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">locationManager:</span><span class="p">(</span><span class="bp">CLLocationManager</span> <span class="o">*</span><span class="p">)</span><span class="nv">manager</span> <span class="nf">didUpdateToLocation:</span><span class="p">(</span><span class="bp">CLLocation</span> <span class="o">*</span><span class="p">)</span><span class="nv">newLocation</span> <span class="nf">fromLocation:</span><span class="p">(</span><span class="bp">CLLocation</span> <span class="o">*</span><span class="p">)</span><span class="nv">oldLocation</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="c1">// test the age of the location measurement to determine if the measurement is cached</span>
</span><span class='line'>    <span class="c1">// in most cases you will not want to rely on cached measurements</span>
</span><span class='line'>    <span class="n">NSTimeInterval</span> <span class="n">locationAge</span> <span class="o">=</span> <span class="o">-</span><span class="p">[</span><span class="n">newLocation</span><span class="p">.</span><span class="n">timestamp</span> <span class="n">timeIntervalSinceNow</span><span class="p">];</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">locationAge</span> <span class="o">&gt;</span> <span class="mf">5.0</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// test that the horizontal accuracy does not indicate an invalid measurement</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">newLocation</span><span class="p">.</span><span class="n">horizontalAccuracy</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// test the measurement to see if it is more accurate than the previous measurement</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">bestEffortAtLocation</span> <span class="o">==</span> <span class="nb">nil</span> <span class="o">||</span> <span class="nb">self</span><span class="p">.</span><span class="n">bestEffortAtLocation</span><span class="p">.</span><span class="n">horizontalAccuracy</span> <span class="o">&gt;</span> <span class="n">newLocation</span><span class="p">.</span><span class="n">horizontalAccuracy</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="c1">// store the location as the &quot;best effort&quot;</span>
</span><span class='line'>        <span class="nb">self</span><span class="p">.</span><span class="n">bestEffortAtLocation</span> <span class="o">=</span> <span class="n">newLocation</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="c1">// test the measurement to see if it meets the desired accuracy</span>
</span><span class='line'>        <span class="c1">//</span>
</span><span class='line'>        <span class="c1">// IMPORTANT!!! kCLLocationAccuracyBest should not be used for comparison with location coordinate or altitidue </span>
</span><span class='line'>        <span class="c1">// accuracy because it is a negative value. Instead, compare against some predetermined &quot;real&quot; measure of </span>
</span><span class='line'>        <span class="c1">// acceptable accuracy, or depend on the timeout to stop updating. This sample depends on the timeout.</span>
</span><span class='line'>        <span class="c1">//</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">newLocation</span><span class="p">.</span><span class="n">horizontalAccuracy</span> <span class="o">&lt;=</span> <span class="n">locationManager</span><span class="p">.</span><span class="n">desiredAccuracy</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="c1">// we have a measurement that meets our requirements, so we can stop updating the location</span>
</span><span class='line'>            <span class="c1">// </span>
</span><span class='line'>            <span class="c1">// IMPORTANT!!! Minimize power usage by stopping the location manager as soon as possible.</span>
</span><span class='line'>            <span class="c1">//</span>
</span><span class='line'>            <span class="p">[</span><span class="nb">self</span> <span class="nl">stopUpdatingLocation</span><span class="p">:</span><span class="n">NSLocalizedString</span><span class="p">(</span><span class="s">@&quot;Acquired Location&quot;</span><span class="p">,</span> <span class="s">@&quot;Acquired Location&quot;</span><span class="p">)];</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>iPhone进入飞行模式并不会立刻停止接受GPS数据。
Location manager获取实时的location需要花费几秒钟，所以location manager会先返回cached location data，然后再返回更新过的数据，所以一定要check location对象的timestamp。
这也解释了，为何在执行<code>[self.locationManager stopUpdatingLocation];</code>之后，<code>- (void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error</code>还是会被call，应该是因为执行stopUpdatingLocation之后，实际上进行数据更新的线程还在运行，发现无法获取数据了，导致又被失败delegate被call了一次。</li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">Regardless</span> <span class="n">of</span> <span class="n">which</span> <span class="n">location</span> <span class="n">service</span> <span class="n">you</span> <span class="n">use</span><span class="p">,</span> <span class="n">location</span> <span class="n">data</span> <span class="n">is</span> <span class="n">reported</span> <span class="n">to</span> <span class="n">your</span> <span class="n">app</span> <span class="n">via</span> <span class="n">the</span> <span class="n">location</span> <span class="n">manager</span><span class="err">’</span><span class="n">s</span> <span class="n">associated</span> <span class="n">delegate</span> <span class="n">object</span><span class="p">.</span> <span class="n">Because</span> <span class="n">it</span> <span class="n">can</span> <span class="n">take</span> <span class="n">several</span> <span class="n">seconds</span> <span class="n">to</span> <span class="k">return</span> <span class="n">an</span> <span class="n">initial</span> <span class="n">location</span><span class="p">,</span> <span class="n">the</span> <span class="n">location</span> <span class="n">manager</span> <span class="n">typically</span> <span class="n">delivers</span> <span class="n">the</span> <span class="n">previously</span> <span class="n">cached</span> <span class="n">location</span> <span class="n">data</span> <span class="n">immediately</span> <span class="n">and</span> <span class="n">then</span> <span class="n">delivers</span> <span class="n">more</span> <span class="n">up</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">date</span> <span class="n">location</span> <span class="n">data</span> <span class="n">as</span> <span class="n">it</span> <span class="n">becomes</span> <span class="n">available</span><span class="p">.</span> <span class="n">Therefore</span> <span class="n">it</span> <span class="n">is</span> <span class="n">always</span> <span class="n">a</span> <span class="n">good</span> <span class="n">idea</span> <span class="n">to</span> <span class="n">check</span> <span class="n">the</span> <span class="n">timestamp</span> <span class="n">of</span> <span class="n">any</span> <span class="n">location</span> <span class="n">object</span> <span class="n">before</span> <span class="n">taking</span> <span class="n">any</span> <span class="n">actions</span><span class="p">.</span> <span class="n">If</span> <span class="n">both</span> <span class="n">location</span> <span class="n">services</span> <span class="n">are</span> <span class="n">enabled</span> <span class="n">simultaneously</span><span class="p">,</span> <span class="n">they</span> <span class="n">deliver</span> <span class="n">events</span> <span class="n">using</span> <span class="n">the</span> <span class="n">same</span> <span class="n">set</span> <span class="n">of</span> <span class="n">delegate</span> <span class="n">methods</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>Deferring updates省电</li>
</ol>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="n">It</span> <span class="n">is</span> <span class="n">recommended</span> <span class="n">that</span> <span class="n">you</span> <span class="n">use</span> <span class="n">this</span> <span class="n">feature</span> <span class="k">in</span> <span class="n">situations</span> <span class="n">where</span> <span class="n">your</span> <span class="n">app</span> <span class="n">could</span> <span class="n">process</span> <span class="n">the</span> <span class="n">data</span> <span class="n">later</span> <span class="n">without</span> <span class="n">any</span> <span class="n">problems</span><span class="p">.</span>
</span><span class='line'><span class="n">An</span> <span class="n">app</span> <span class="n">that</span> <span class="n">tracks</span> <span class="n">the</span> <span class="n">user</span><span class="err">’</span><span class="n">s</span> <span class="n">location</span> <span class="n">on</span> <span class="n">a</span> <span class="n">hiking</span> <span class="n">trail</span> <span class="n">could</span> <span class="n">defer</span> <span class="n">updates</span> <span class="n">until</span> <span class="n">the</span> <span class="n">user</span> <span class="n">hikes</span> <span class="n">a</span> <span class="n">certain</span> <span class="n">distance</span> <span class="n">and</span> <span class="n">then</span> <span class="n">process</span> <span class="n">the</span> <span class="n">points</span> <span class="n">all</span> <span class="n">at</span> <span class="n">once</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Video: Growth Is Good but Retention Is 4ever at Wmd Conference by Brian Balfour]]></title>
    <link href="http://iandai.github.io/blog/2015/06/16/video-growth-is-good-but-retention-is-4ever-at-wmd-conference-by-brian-balfour/"/>
    <updated>2015-06-16T12:39:00+02:00</updated>
    <id>http://iandai.github.io/blog/2015/06/16/video-growth-is-good-but-retention-is-4ever-at-wmd-conference-by-brian-balfour</id>
    <content type="html"><![CDATA[<p>Source:<br/>
<a href="https://growthhackers.com/videos/video-growth-is-good-but-retention-is-4ever-at-wmd-conference-by-brian-balfour/">https://growthhackers.com/videos/video-growth-is-good-but-retention-is-4ever-at-wmd-conference-by-brian-balfour/</a></p>

<p>Summary:<br/>
Brain Balfour 讲为何retention为王。因为有了retention，其他的自然会来。<br/>
Increase retention -> Increase LTV -> Afford Higher CPA<br/>
Increase retention -> increase upgrade rates -> decrease payback period<br/>
其中有一个重要的点在于，有时候因为有许多新用户的增加和短期retention较高的水平，导致盲目投入，最后眼睁睁看着用户都流失掉。<br/>
所以retention最后要是一条水平线，而不能一直下垂。<br/>
讲了实际案例，如何预防retention下降的趋势，如何想办法提高retention。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A/B Testing: Why, What, When, How by Mike Greenfield]]></title>
    <link href="http://iandai.github.io/blog/2015/06/15/a-slash-b-testing-why-what-when-how-by-mike-greenfield/"/>
    <updated>2015-06-15T13:22:05+02:00</updated>
    <id>http://iandai.github.io/blog/2015/06/15/a-slash-b-testing-why-what-when-how-by-mike-greenfield</id>
    <content type="html"><![CDATA[<p>Source:<br/>
<a href="http://www.slideshare.net/500startups/ab-testing-with-mike-greenfield">http://www.slideshare.net/500startups/ab-testing-with-mike-greenfield</a></p>

<p>Summary:<br/>
回答why, what, when, how和经验。<br/>
why因为有了数据才能衡量任何东西。<br/>
what 不要测试不能影响全局的细小因素。<br/>
when 只测试能够带来business significant的内容，经验是1万到10万人才值得做AB测试。<br/>
How 建自己的framework，这样才更佳自由。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A/B Testing: When to Do A/B Testing by Mike Greenfield.]]></title>
    <link href="http://iandai.github.io/blog/2015/06/15/when-to-do-a-slash-b-testing-a-primer-on-a-slash-b-testing-by-mike-greenfield/"/>
    <updated>2015-06-15T13:14:39+02:00</updated>
    <id>http://iandai.github.io/blog/2015/06/15/when-to-do-a-slash-b-testing-a-primer-on-a-slash-b-testing-by-mike-greenfield</id>
    <content type="html"><![CDATA[<p>Source:<br/>
<a href="http://numeratechoir.com/a-primer-on-ab-testing-yummy-candy/">http://numeratechoir.com/a-primer-on-ab-testing-yummy-candy/</a></p>

<p>Summary:<br/>
什么时候要做AB测试，非常靠谱的回答。<br/>
对于signup和邀请好友。如果受到邀请的好友signup，只有邀请人的0.8%，那么不应该做AB Testing。<br/>
对Email的Title和content做AB testing往往会有很好的效果。不过做之前，要想好会不会有大影响。如果email每天只有100个打开率，那么再优化，也不会有什么大影响。   <br/>
Purchase funnel也非常值得做AB测试。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> - Viral signup flows. If your current signup flow features 1000 signups inviting 3000 people, 900 of whom register for your product, you’re very close to being viral (K=0.9). A/B testing would be a good use of time. If your current flow features 1000 signups inviting 600 people, 80 of whom join (K=0.08), then you aren’t in the ballpark: optimizing button text is likely a waste of time. Go bigger.
</span><span class='line'> - Email content. Subject lines and link text can have a huge impact on email clickthrough rates. One typical example: an email with the subject “5 Embarrassing Kid Moments” gets 2.5 times as many clicks as one with the subject “The Craziest Thing My Child Has Done.” But again, being close to “good” is key: if that 2.5x is the difference between 50 clicks a week and 125 clicks a week, does it matter? If it doesn’t matter (and good estimation is key), no point spending time A/B testing it.
</span><span class='line'> - Purchase funnel. Much of Team Rankings‘ revenue comes from subscriptions, and some purchase funnels can be much more effective than others. Last year, for instance, our March Madness product, BracketBrains, generated 30% more sales when we prompted people to “Get 2011 Picks” than to “Get BracketBrains”. Same caveats apply here, though: test if and only if the differences are likely to matter for your business.</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Video: 10 Habits of High-Growth Startups by Sean Ellis]]></title>
    <link href="http://iandai.github.io/blog/2015/06/15/video-10-habits-of-high-growth-startups-by-sean-ellis/"/>
    <updated>2015-06-15T12:25:06+02:00</updated>
    <id>http://iandai.github.io/blog/2015/06/15/video-10-habits-of-high-growth-startups-by-sean-ellis</id>
    <content type="html"><![CDATA[<p>Source:<br/>
<a href="https://growthhackers.com/videos/10-habits-of-high-growth-startups-by-sean-ellis/">https://growthhackers.com/videos/10-habits-of-high-growth-startups-by-sean-ellis/</a></p>

<p>Summary:<br/>
Video: 10 Habits of High-Growth Startups by Sean Ellis<br/>
第一次提出Growth Hacker这个名字的人Sean Ellis的演讲：10个让创业公司快速成长的习惯<br/>
1 Putting the first thing first. 意思是做一个好的产品是一切的基础，A product that worth growth<br/>
2 Curious about Customers. 倾听你的customer，看他们是否觉得你提供的service有价值，是否一个must have的service<br/>
3 Instrument Powerful Analytics<br/>
4 Optimize Conversions<br/>
5 Treat Growth as Team Sport 各个team之间，透明很重要。客服和工程师提出的想法的角度往往不同<br/>
6 Experiment on Ideas 测试才能知道idea的效果，往往你觉得有用的没用，你觉得没用的反而有用<br/>
7 Prioritize Resources for Growth   <br/>
8 Execute at High Tempo 执行要快，并发执行实验<br/>
9 Accontability for inputs 要有足够的输出，就要有足够的输入<br/>
10 Double Down on Success  在已经有效果的channel上面，更加深入和精细，以求获得更好的效果</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linkedin Use Dark Pattern Design to Get New User]]></title>
    <link href="http://iandai.github.io/blog/2015/06/15/linkedin-use-dark-pattern-design-to-get-new-user/"/>
    <updated>2015-06-15T12:19:41+02:00</updated>
    <id>http://iandai.github.io/blog/2015/06/15/linkedin-use-dark-pattern-design-to-get-new-user</id>
    <content type="html"><![CDATA[<p>Source: <br/>
<a href="https://medium.com/@danrschlosser/linkedin-dark-patterns-3ae726fe1462">https://medium.com/@danrschlosser/linkedin-dark-patterns-3ae726fe1462</a></p>

<p>Summary:<br/>
Linkedin的黑暗设计模式：通过设计的方法，利用用户的误解或者疏忽，获取的用户的全部邮件好友列表。<br/>
获取注册用户的好友，对于Linkedin来说是非常重要的。Linkedin通过设计，让你不经意间授权了他获取好友email列表，然后让你不经意间邀请那些不在Linkedin上的好友。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Successful Mobile App Entrepreneurs]]></title>
    <link href="http://iandai.github.io/blog/2015/06/12/successful-mobile-app-entrepreneurs/"/>
    <updated>2015-06-12T12:13:36+02:00</updated>
    <id>http://iandai.github.io/blog/2015/06/12/successful-mobile-app-entrepreneurs</id>
    <content type="html"><![CDATA[<p>Source:  <br/>
<a href="http://thenextweb.com/entrepreneur/2015/06/02/9-daily-habits-of-successful-mobile-app-entrepreneurs/">http://thenextweb.com/entrepreneur/2015/06/02/9-daily-habits-of-successful-mobile-app-entrepreneurs/</a></p>

<p>Summary:
要做好mobile app entrepreneurs，应该做的9件事儿。
有启发的两件事儿是：<br/>
1.研究App Store，研究好的APP好在哪儿，不好的地方哪儿可以提高的，熟悉App Store的算法是如何工作的。
2.跟不好的APP学习。找出一些共同的patten，自己要避免。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Average Reteion for Google Play Apps by Andrew Chen]]></title>
    <link href="http://iandai.github.io/blog/2015/06/12/average-reteion-for-google-play-apps/"/>
    <updated>2015-06-12T08:41:08+02:00</updated>
    <id>http://iandai.github.io/blog/2015/06/12/average-reteion-for-google-play-apps</id>
    <content type="html"><![CDATA[<p>Source:<br/>
<a href="http://andrewchen.co/new-data-shows-why-losing-80-of-your-mobile-users-is-normal-and-that-the-best-apps-do-much-better/">http://andrewchen.co/new-data-shows-why-losing-80-of-your-mobile-users-is-normal-and-that-the-best-apps-do-much-better/</a></p>

<p>Summary:<br/>
Andrew Chen的文章：New data shows losing 80% of mobile users is normal, and why the best apps do better。<br/>
题目就是普通流失80%用户是正常的，而好的APP做的比这好的多。<br/>
作者分析了1亿多用户的Google Play apps的Average retention，发现平均起来，前三天会流失77%的用户，前90天会流失95%的用户。<br/>
另外根据作者和朋友的经验，持续使用超过一周的用户，往往持续使用比较久的时间。</p>
]]></content>
  </entry>
  
</feed>
