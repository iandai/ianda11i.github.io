<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ios | Ian's Tech Note]]></title>
  <link href="http://iandai.github.io/blog/categories/ios/atom.xml" rel="self"/>
  <link href="http://iandai.github.io/"/>
  <updated>2018-08-01T22:21:36+02:00</updated>
  <id>http://iandai.github.io/</id>
  <author>
    <name><![CDATA[Ian Dai]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Thoughts on Refactor ä¸€æ¬¡é‡æ„çš„æ€è€ƒ]]></title>
    <link href="http://iandai.github.io/blog/2018/08/01/thoughts-on-re%5B%3F%5D-ci-zhong-gou-de-si-kao/"/>
    <updated>2018-08-01T22:09:29+02:00</updated>
    <id>http://iandai.github.io/blog/2018/08/01/thoughts-on-re[?]-ci-zhong-gou-de-si-kao</id>
    <content type="html"><![CDATA[<p>åŠ å…¥å…¬å¸çš„æ—¶å€™ï¼ŒiOSå®¢æˆ·ç«¯ä»£ç æ¯”è¾ƒæ··ä¹±ã€‚<br/>
æ¯”å¦‚æœ‰ä¸€äº›æ–¹æ³•éå¸¸çš„é•¿ï¼ŒåŒ…å«äº†è®¸å¤šé€»è¾‘ï¼›è®¸å¤šæ— ç”¨çš„ä»£ç ç­‰ã€‚<br/>
åŸæ¥çš„ä»£ç ä¸»è¦æ˜¯ç”±å‡ ä¸ªä¸åŒçš„freelancerå†™æˆçš„ï¼Œæ‰€ä»¥ä»£ç ä¸€æ–¹é¢éš¾ä»¥ç†è§£ï¼Œä¸€æ–¹é¢ä¹Ÿä¸å®¹æ˜“ç»´æŠ¤å’Œå¢åŠ æ–°åŠŸèƒ½ã€‚<br/>
æ‰€ä»¥è¿›è¡Œäº†ä¸€æ¬¡é‡æ„ã€‚</p>

<h3>é‡æ„é¡¹ç›®æœ€é‡è¦çš„æ˜¯ä»€ä¹ˆï¼Ÿ</h3>

<p>é¡¹ç›®è´£ä»»äººçš„çœŸæ­£çš„è®¤å¯å’Œæ”¯æŒã€‚ä»–éœ€è¦ç†è§£é‡æ„éœ€è¦èŠ±è´¹çš„æˆæœ¬å’Œèƒ½å¤Ÿè·å–çš„æ”¶ç›Šã€‚<br/>
é‡æ„èŠ±è´¹çš„æˆæœ¬ï¼Œåªèƒ½çœ‹è§ä¸å¤šçš„ä¸šåŠ¡æ”¶ç›Šã€‚<br/>
åªæœ‰é¡¹ç›®è´Ÿè´£äººçœŸæ­£è®¤å¯ï¼Œæ‰èƒ½åœ¨é¡¹ç›®æ²¡æœ‰æ˜æ˜¾è¿›åº¦çš„æ—¶å€™ï¼Œé¡¶ä½å‹åŠ›ï¼Œæ­£ç¡®åˆ¶å®šé¡¹ç›®è¿›åº¦è®¡åˆ’ã€‚<br/>
å¯¹å¼€å‘äººå‘˜æ¥è¯´ï¼Œä¹Ÿéœ€è¦ç†è§£è¿™ç§æƒ…å†µã€‚åœ¨é‡æ„çš„æ—¶å€™ï¼Œå°½é‡èƒ½æå‡æ„æ¶çš„åŒæ—¶ï¼Œä¹Ÿè¦æœ‰ä¸šåŠ¡æ–¹é¢çš„æ”¶ç›Šã€‚</p>

<h3>é‡æ„çš„ç›®æ ‡</h3>

<p>æŠ€æœ¯ä¸Šçš„ç›®æ ‡ï¼šæœ‰æ¸…æ™°çš„åˆ†å±‚ï¼Œå°½å¯èƒ½è§£è—•ï¼Œä»¥æé«˜å¯è¯»æ€§å’Œå¯æ‰©å±•æ€§ä¸ºä¸»ï¼›å‡å°‘é€»è¾‘æ··ä¹±å¸¦æ¥çš„ä¸€äº›bugã€‚<br/>
ä¸šåŠ¡ä¸Šçš„ç›®æ ‡ï¼šä¼˜åŒ–éƒ¨åˆ†åŠŸèƒ½ï¼›è§£å†³è¯­è¨€å›½é™…åŒ–ä¸Šçš„ä¸è¶³ï¼›æå‡å¯¹å¤šç§è®¾å¤‡çš„å¤šæ–¹é¢æ”¯æŒã€‚<br/>
èŒƒå›´ä¸Šçš„ç›®æ ‡ï¼šå…¨éƒ¨é‡å†™æ‰€æœ‰é€»è¾‘ï¼Œä¼šè€—è´¹éå¸¸å¤šçš„æ—¶é—´ã€‚é‡æ„æŠ“å¤§æ”¾å°ï¼Œä¸»è¦é‡æ„ç»å¸¸è®¿é—®çš„æ¨¡å—ï¼Œå¦‚ç”¨æˆ·ç™»é™†æ¨¡å—ï¼ŒIndexæ¨¡å—ï¼Œé¡¹ç›®æ¨¡å—ã€‚</p>

<h3>é‡æ„çš„æ­¥éª¤</h3>

<p>1ï¼Œåˆ é™¤ä¸ç”¨çš„å›¾ç‰‡å’Œä»£ç <br/>
2ï¼Œè§£å†³ä¸€éƒ¨åˆ†Warningï¼Œæ¯”å¦‚å˜é‡æœªä½¿ç”¨<br/>
3ï¼Œé‡æ–°ç»„ç»‡æ–‡ä»¶ç›®å½•ç»“æ„<br/>
4ï¼ŒæŠ½è±¡å‡ºæ¨¡å—<br/>
5ï¼Œç»Ÿä¸€ä»£ç è§„èŒƒ<br/>
6ï¼Œä¿®å¤ä¸€ä¸ªbugæˆ–è€…å»ºç«‹ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œå°±é‡æ„ç›¸å…³çš„ä»£ç ï¼Œä»¥å°½é‡ç¼©å°å½±å“èŒƒå›´</p>

<h3>æ–‡ä»¶ç›®å½•ç»“æ„</h3>

<p>Top layer</p>

<pre><code>-[ProjectName]
    --Features       
    --Categories   
    --Frameworks 
    --Helpers  
    --Utilites    
    --Vendors     
    --Config   
    --Resources     
    --AppEntry 
-Tests
-UITests
-Products         
-Pods
</code></pre>

<p>Second layer</p>

<pre><code>--Features         
    ---Base            
        ----Models      
        ----Views       
        ----Controllers 
        ----Managers      
    ---Login
        ----Models
        ----Views
        ----Controllers
        ----Managers      
    ---Profile
        ----Models
        ----Views
        ----Controllers
        ----Managers      
    ---Home
        ----Models
        ----Views
        ----Controllers
        ----Managers      
</code></pre>

<h3>ä»£ç è§„èŒƒ</h3>

<p>1, Follow <a href="https://github.com/NYTimes/objective-c-style-guide">NYTimes objective-c style</a><br/>
2, Use <a href="https://github.com/mapbox/XcodeClangFormat">XcodeClangFormat</a> to format source code to unify the source code style.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[UITableView Adaption With iPhoneX]]></title>
    <link href="http://iandai.github.io/blog/2018/05/25/uitableview-adaption-with-iphonex/"/>
    <updated>2018-05-25T14:26:28+02:00</updated>
    <id>http://iandai.github.io/blog/2018/05/25/uitableview-adaption-with-iphonex</id>
    <content type="html"><![CDATA[<h2>é—®é¢˜</h2>

<p>UITableViewåœ¨iPhoneXä¸Šä¼šæœ‰20pt/64ptçš„åç§»ã€‚<br/>
å…¶åŸå› æ˜¯ç”±äºiOS11åºŸå¼ƒäº†UIViewControllerçš„automaticallyAdjustsScrollViewInsetså±æ€§ï¼Œæ–°å¢äº†contentInsetAdjustmentBehaviorå±æ€§ã€‚  æ‰€ä»¥å½“è¶…å‡ºå®‰å…¨åŒºåŸŸæ—¶ç³»ç»Ÿè‡ªåŠ¨è°ƒæ•´äº†SafeAreaInsetsï¼Œè¿›è€Œå½±å“äº†adjustedContentInsetï¼Œåœ¨iOS11ä¸­å†³å®štableViewå†…å®¹ä¸è¾¹ç¼˜è·ç¦»çš„æ˜¯adjustedContentInsetï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®UIScrollViewçš„contentInsetAdjustmentBehaviorå±æ€§ã€‚</p>

<h2>è§£å†³æ–¹æ³•</h2>

<h3>1.æ‰‹åŠ¨é€‚é…</h3>

<p>å¦‚æœä½ ä½¿ç”¨äº†UITableViewã€UIScrollViewï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä»¥ä¸‹ä»£ç åšé€‚é…ï¼Œè¿™æ ·ç³»ç»Ÿå°±ä¸ä¼šä¸»åŠ¨ä¸ºä½ è®¾ç½®è¾¹ç¼˜è·ç¦»ï¼Œä½†æ˜¯ä½ å¯èƒ½éœ€è¦æ‰‹åŠ¨é€‚é…UITableViewçš„contenteInsetã€‚</p>

<pre><code class="Objc">  #ifdef __IPHONE_11_0  
  // å•ç‹¬ä½œç”¨ä¸æŸä¸ªtableView
  if ([tableView respondsToSelector:@selector(setContentInsetAdjustmentBehavior:)]) {
    tableView.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;
  }
  // ä½œç”¨ä¸æ‰€æœ‰çš„UIScrollView
  UIScrollView.appearance.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;
  // è®¾ç½®viewçš„å®½é«˜
  tableView.contentInset = UIEdgeInsetsMake(0, 0, 34, 0);
  #endif
</code></pre>

<h3>2.è‡ªåŠ¨é€‚é…</h3>

<p>è®¾ç½®contentInsetAdjustmentBehaviorå±æ€§ä¸ºUIScrollViewContentInsetAdjustmentAutomaticï¼Œåˆ™ç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—contentViewçš„åç§»é‡ã€‚</p>

<h3>3.è®¾ç½®å®‰å…¨åŒºåŸŸçš„addtionalSafeAreaInset</h3>

<p>æŸäº›æƒ…å†µä¸‹ï¼Œä½ éœ€è¦é¡¶éƒ¨åŒºåŸŸï¼Œæ¯”å¦‚å¹¿å‘ŠåŒºåŸŸè¦†ç›–Statusï¼Œåˆ™å¯ä»¥è®¾ç½®ç›¸åº”é¡µé¢çš„addtionalSafeAreaInsetå±æ€§ï¼Œè¿™æ ·ç³»ç»Ÿä¸ä¼šå°†safeAreaä¸Šè°ƒåˆ°ä»statuså¼€å§‹ã€‚è¿™æ ·å¯ä»¥æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚<br/>
ä¾‹å¦‚å¦‚æœä½ çš„SafeAreaInsetå€¼ä¸º(44,0,0,0)ï¼Œåˆ™éœ€è¦è®¾ç½®ç›¸åº”çš„additionalSafeAreaInsetså€¼ä¸º(-44,0,0,0)ã€‚</p>

<pre><code class="Objc">  if (@available(iOS 11.0, *)) {
      self.additionalSafeAreaInsets = UIEdgeInsetsMake(-44, 0, 0, 0);
  } else {
      // Fallback on earlier versions
  }
</code></pre>

<h3>4.è‡ªåŠ¨ä¼°ç®—è¡Œé«˜</h3>

<p>iOS11å¼€å§‹UITableViewå¼€å¯äº†è‡ªåŠ¨ä¼°ç®—è¡Œé«˜ï¼ŒestimatedRowHeight estimatedSectionHeaderHeight estimatedSectionFooterHeight ä¸‰ä¸ªé«˜åº¦ä¼°ç®—å±æ€§ç”±é»˜è®¤çš„0å˜æˆäº†UITableViewAutomaticDimensionã€‚  æ‰€ä»¥heightForHeaderInSectionå’ŒviewForHeaderInSectionåº”è¯¥ä¸€èµ·ä½¿ç”¨ï¼Œä¸ç„¶tableViewé¡¶éƒ¨æ»‘åŠ¨çš„æ—¶å€™ä¼šæœ‰ç©ºç™½ã€‚<br/>
åœ¨é€‚é…è¿‡ç¨‹ä¸­å‘ç°UITableViewä¼šåœ¨Header/Footerè¿”å›sizeä¸ºè´Ÿå€¼çš„æƒ…å†µä¸‹ä¼šå´©æºƒã€‚</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[NSString, Unicodeå’ŒNSCharacterSet]]></title>
    <link href="http://iandai.github.io/blog/2017/01/05/nsstring-unicodehe-nscharacterset/"/>
    <updated>2017-01-05T15:57:17+01:00</updated>
    <id>http://iandai.github.io/blog/2017/01/05/nsstring-unicodehe-nscharacterset</id>
    <content type="html"><![CDATA[<h2>Unicode</h2>

<h3>Convert unicode ponit to eomji using universal character names</h3>

<blockquote><p>Universal character names are formed by a prefix \U followed by an eight-digit Unicode code point, or by a prefix \u followed by a four digit Unicode code point.
For Unicode surrogate pairs, specify the universal character name by using \UNNNNNNNN, where NNNNNNNN is the eight-digit code point for the character. The compiler generates a surrogate pair if required.
In Objc, \U also handles Emoji ZWJ Sequences.</p></blockquote>

<p>For example:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// ç”¨Universal character names \Uå’Œ\u æ›¿æ¢
</span><span class='line'>NSString *str = @&ldquo;The Greek letter Beta looks like this: \u03b2, and the emoji for books looks like this: \U00010437&rdquo;;
</span><span class='line'>NSLog(@&ldquo;%@&rdquo;, str);&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;// å¤„ç† Surrogate Pairs
</span><span class='line'>// æ–¹æ³•ä¸€
</span><span class='line'>NSString *str2 = [NSString stringWithCharacters:(unichar[]){0x263A, 0xFE0F} length:2];
</span><span class='line'>NSLog(@"%@", str2);
</span><span class='line'>// æ–¹æ³•äºŒ
</span><span class='line'>NSString *str3 = [NSString stringWithFormat:@"\U0000263A\U0000FE0F"];
</span><span class='line'>NSLog(@"%@", str3);
</span><span class='line'>// æ–¹æ³•ä¸‰
</span><span class='line'>// NSString  initWithBytes
</span><span class='line'>// supports Surrogate Pairs, does not support Emoji ZWJ Sequences
</span><span class='line'>const unichar chars1[] = {0x263A, 0xFE0F};
</span><span class='line'>NSString *str4 = [[NSString alloc] initWithBytes:chars1 length:sizeof(chars1) encoding:NSUTF16LittleEndianStringEncoding];
</span><span class='line'>NSLog(@"%@", str4);
</span><span class='line'>// æ–¹æ³•å››
</span><span class='line'>// NSString  initWithBytes
</span><span class='line'>// works on utf32
</span><span class='line'>uint32_t base_point_UTF32 = 0x1F600;
</span><span class='line'>NSString *str5 = [[NSString alloc] initWithBytes:&amp;base_point_UTF32 length:4 encoding:NSUTF32LittleEndianStringEncoding];
</span><span class='line'>NSLog(@"%@", str5);
</span><span class='line'>// æ–¹æ³•äº”
</span><span class='line'>//CFStringGetSurrogatePairForLongCharacter
</span><span class='line'>UniChar c[2];
</span><span class='line'>CFStringGetSurrogatePairForLongCharacter(0x1F600, c);
</span><span class='line'>NSString *str6 = [[NSString alloc] initWithCharacters:c length:2];
</span><span class='line'>NSLog(@"%@", str6);
</span><span class='line'>
</span><span class='line'>// å¤„ç†Emoji ZWJ Sequences
</span><span class='line'>// æ–¹æ³•ä¸€
</span><span class='line'>NSString *str7 = [NSString stringWithFormat:@"\U0001F468\U0000200D\U00002695\U0000FE0F"];
</span><span class='line'>NSLog(@"%@", str7);
</span><span class='line'>// æ–¹æ³•äºŒ
</span><span class='line'>NSString *str8 = [NSString stringWithFormat:@"ğŸ‘¨\u200DğŸ‘©\u200DğŸ‘§\u200DğŸ‘¦"]; //ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦
</span><span class='line'>NSLog(@"%@", str8);
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;
</span><span class='line'>
</span><span class='line'>## CharacterSet
</span><span class='line'>
</span><span class='line'>### æ£€æµ‹CharacterSetåŒ…å«äº†å“ªäº›å­—ç¬¦
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;NSCharacterSet *charSet = [NSCharacterSet symbolCharacterSet];&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;int count = 1;
</span><span class='line'>for (unichar i = 0; i&lt;65535; i++) {
</span><span class='line'>if ([charSet characterIsMember:i]) {
</span><span class='line'>    NSLog(@&ldquo;character %d = %C&rdquo;,i,i);
</span><span class='line'>    count++;
</span><span class='line'>}
</span><span class='line'>}
</span><span class='line'>NSLog(@&ldquo;found %d characters out of 65536&rdquo;,count);</span></code></pre></td></tr></table></div></figure></p>

<h2>More about unicode and emoji</h2>

<p><a href="http://www.unicode.org/faq/emoji_dingbats.html">Emoji and Pictographs</a><br/>
<a href="http://cyrilwei.me/swift/2016/08/31/the-emoji.html">The Emoji, is not what you expected</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å¦‚ä½•æ£€æµ‹å’Œåˆ é™¤NSStringä¸­çš„é¢œæ–‡å­—Emoji]]></title>
    <link href="http://iandai.github.io/blog/2017/01/05/ru-he-jian-ce-he-shan-chu-nsstringzhong-de-yan-wen-zi-emoji/"/>
    <updated>2017-01-05T14:52:29+01:00</updated>
    <id>http://iandai.github.io/blog/2017/01/05/ru-he-jian-ce-he-shan-chu-nsstringzhong-de-yan-wen-zi-emoji</id>
    <content type="html"><![CDATA[<h2>é—®é¢˜</h2>

<p>æœ‰ä¸€ä¸ªéœ€æ±‚æ˜¯è·å–è”ç³»äººå§“åçš„é¦–å­—æ¯ï¼Œä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªé¦–å­—æ¯ç»˜åˆ¶è”ç³»äººç”¨æˆ·å¤´åƒã€‚æœ‰çš„ç”¨æˆ·åå­—é¦–å­—æ¯æ˜¯é¢œæ–‡å­—ï¼Œç»˜åˆ¶å°±ä¼šå‡ºç°ä¹±ç ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>

<pre><code class="Objc">NSMutableString *initials = [NSMutableString string];
NSArray *words = [contactName componentsSeparatedByCharactersInSet:[NSCharacterSet whitespaceCharacterSet]];
for (NSString *word in words) {
    if (word.length &gt; 0) {
        NSString *firstLetter = [word substringToIndex:1];
        [initials appendString:[firstLetter uppercaseString]];
    }
}
</code></pre>

<p>ä¹±ç æ¥è‡ªäºåå­—ä¸­çš„é¢œæ–‡å­—ï¼Œå½“<code>[word substringToIndex:1]</code>ä¸­çš„wordæ˜¯é¢œæ–‡å­—çš„æ—¶å€™ï¼Œå…¶è¿”å›å€¼å¹¶ä¸æ˜¯ä¸€ä¸ªæ­£å¸¸çš„é¢œæ–‡å­—ã€‚</p>

<p>åŸå› æ˜¯<code>[word length]</code>ç»“æœæ˜¯2ï¼Œæ‰€ä»¥<code>[word substringToIndex:1]</code>å…¶å®åªè¿”å›äº†é¢œæ–‡å­—çš„ä¸€åŠã€‚</p>

<p>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿè¿™æ˜¯å› ä¸º<code>word</code>æ˜¯ä¸€ä¸ªNSStringç±»å‹ï¼Œè€ŒNSStringæ˜¯UTF-16ç¼–ç çš„ã€‚è®¸å¤šé¢œæ–‡å­—åœ¨ä½¿ç”¨UTF-16è¡¨ç¤ºçš„æ—¶å€™ï¼Œè¦æ˜¯ç”¨ä¸¤ä¸ªå­—èŠ‚æ‰èƒ½è¡¨ç¤ºï¼Œæ¯”å¦‚ğŸ˜€ã€‚</p>

<p>NSStringç±»çš„<a href="https://developer.apple.com/reference/foundation/nsstring">æ–‡æ¡£</a>é‡Œå†™åˆ°ï¼š</p>

<blockquote><p>An NSString object encodes a Unicode-compliant text string, represented as a sequence of UTFâ€“16 code units. All lengths, character
indexes, and ranges are expressed in terms of 16-bit platform-endian values, with index values starting at 0.</p></blockquote>

<h2>è§£å†³æ–¹æ³•</h2>

<h3>1.ä»å­—ç¬¦ä¸²ä¸­è·å¾—æ­£ç¡®å®Œæ•´çš„å­—ç¬¦</h3>

<pre><code class="Objc">__block NSString *firstLetter = @"";
[word enumerateSubstringsInRange:NSMakeRange(0, [word length])
                         options:NSStringEnumerationByComposedCharacterSequences
                      usingBlock: ^(NSString* substring, NSRange substringRange, NSRange enclosingRange, BOOL* stop) {
                          firstLetter = substring;
                          *stop = YES;
                      }];
</code></pre>

<p>ä½¿ç”¨<code>NSStringEnumerationByComposedCharacterSequences</code>èƒ½å¤Ÿè¯»å–å®Œæ•´çš„é¢œæ–‡å­—ï¼Œè€Œä¸æ˜¯åªè¯»å–å…¶ä¸­ä¸€ä¸ªå­—èŠ‚ã€‚</p>

<h3>2.æ£€æµ‹å’Œåˆ é™¤æ˜¯å¦åŒ…å«é¢œæ–‡å­—</h3>

<p>Githubä¸Šæœ‰ä¸€ä¸ªæ¯”è¾ƒå¤šäººå‚è€ƒçš„é¡¹ç›®<a href="https://github.com/woxtu/NSString-RemoveEmoji">NSString-RemoveEmoj</a>ã€‚è¿™ä¸ªé¡¹ç›®æœ‰é—æ¼é¢œæ–‡å­—ï¼Œæ¯”å¦‚â­ï¼ŒåŒ…å«äº†è®¸å¤šä¸æ˜¯é¢œæ–‡å­—çš„å­—ç¬¦ï¼Œæ¯”å¦‚â…¦ã€‚</p>

<p>åœ¨unicode.orgç½‘ç«™ä¸Šï¼Œæœ‰<a href="http://unicode.org/Public/emoji/4.0/emoji-test.txt">å®Œæ•´çš„é¢œæ–‡å­—åˆ—è¡¨</a>ã€‚éå†è¿™ä¸ªå®Œæ•´çš„åˆ—è¡¨ï¼Œå°±å¯ä»¥æ£€æµ‹å­—ç¬¦ä¸²ä¸­æ˜¯å¦é¢œæ–‡å­—ã€‚æ–¹æ³•å¦‚ä¸‹ï¼š</p>

<pre><code class="Objc">// å»ºç«‹ä¸€ä¸ªemoji CharacterSet
NSMutableCharacterSet *emojiCharacterSet = [[NSMutableCharacterSet alloc] init];
NSString *plistPath = [[NSBundle mainBundle] pathForResource:@"emoji" ofType:@"plist"];
NSArray *emojiArr = [NSArray arrayWithContentsOfFile:plistPath];
for (NSString *emoji in emojiArr) {
    [emojiCharacterSet addCharactersInString:emoji];
}

// - (NSRange)rangeOfCharacterFromSet:(NSCharacterSet *)searchSet;
[@"ğŸ˜€" rangeOfCharacterFromSet:set]; 
</code></pre>

<p>ä¸Šé¢ä»£ç è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ²¡æœ‰è¢«è€ƒè™‘ã€‚æ¯”å¦‚ä¸‹é¢è¿™ç§æƒ…å†µï¼š</p>

<pre><code class="Objc">
NSMutableCharacterSet *set = [[NSMutableCharacterSet alloc] init];
[set addCharactersInString:@"2ï¸âƒ£"];      // keycap 2, 0032 FE0F 20E3, check from http://www.iemoji.com/view/emoji/296/symbols/keycap-2 
[@"2" rangeOfCharacterFromSet:set];     // return value: YES, which is not reasonable 
</code></pre>

<p>å­—ç¬¦2åœ¨æœç´¢åŒ…å«æœ‰é¢œæ–‡å­—2çš„å­—ç¬¦é›†çš„æ—¶å€™ï¼Œä¼šè¢«é”™è¯¯çš„æ£€æµ‹å‡ºæ¥ã€‚</p>

<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å†™äº†<a href="https://github.com/iandai/IDEmojiString">IDEmojiStringé¡¹ç›®</a>ã€‚</p>

<h3>3.IDEmojiString</h3>

<p>IDEmojiStringé€šè¿‡ä½¿å•å­—ç¬¦å’Œå¤šå­—ç¬¦åˆ†åˆ«æœç´¢å­—ç¬¦é›†ï¼Œè§£å†³äº†ä¸Šé¢çš„é—®é¢˜ã€‚</p>

<p>ä½¿ç”¨CocoaPodså®‰è£…ä¹‹åï¼Œé€šè¿‡ä»¥ä¸‹æ–¹æ³•ä½¿ç”¨ï¼š
<code>Objc
//#import "IDEmojiManager.h"
IDEmojiManager *manager = [[IDEmojiManager alloc] init];
BOOL containsEmoji = [manager containEmojiInString:@"Some Stringâ­"];  // return value: YES
NSString *str = [manager removeEmojiFromString:@"Some Stringâ­"];      // return value: Some String
</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Optional in Swift -- ä½¿ç”¨Swift Optionalçš„å¥½å¤„]]></title>
    <link href="http://iandai.github.io/blog/2016/08/20/optional-in-swift-shi-yong-swift-optionalde-hao-chu/"/>
    <updated>2016-08-20T16:57:38+02:00</updated>
    <id>http://iandai.github.io/blog/2016/08/20/optional-in-swift-shi-yong-swift-optionalde-hao-chu</id>
    <content type="html"><![CDATA[<p>çœ‹è¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œéœ€è¦äº†è§£Swiftä¸­<a href="https://developer.apple.com/library/ios/referencelibrary/GettingStarted/DevelopiOSAppsSwift/Lesson1.html#//apple_ref/doc/uid/TP40015214-CH3-SW1">Optionalçš„åŸºç¡€çŸ¥è¯†</a>ã€‚</p>

<p>ä½œä¸ºå†™äº†å‡ å¹´çš„Objective-cçš„å¼€å‘è€…ï¼Œå¯¹åœ¨Swiftä¸­ä½¿ç”¨OptionalæŒæœ‰è¿‡æ€€ç–‘æ€åº¦ã€‚ä½¿ç”¨äº†Optionalï¼Œéœ€è¦æ·»åŠ çƒ¦äººçš„ï¼Ÿå’Œï¼ã€‚ä½¿ç”¨äº†ï¼Ÿå’Œï¼ä¹‹åï¼Œä¾ç„¶éœ€è¦åšnilæ£€æŸ¥ï¼›ä½¿ç”¨äº†Valueï¼ä¹‹åï¼Œä¾ç„¶ä¼šåœ¨è¿è¡Œæ—¶å› ä¸ºnilé—®é¢˜è€Œcrashã€‚</p>

<p>ä½¿ç”¨Optionalæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ</p>

<h2>ä½¿ç”¨ç†ç”±1: é¢„å…ˆå®šä¹‰å¥½é€šç”¨çš„å¯¹è±¡ä¸å­˜åœ¨çš„æ—¶å€™çš„å†™æ³•</h2>

<p>è€ƒè™‘ä¸‹é¢çš„ä¾‹å­ï¼š</p>

<pre><code class="objc">- (NSString *)findStockCode:(NSString *)company {
    if ([company isEqualToString:@"Apple"]) {
        return @"AAPL";
    } else if ([company isEqualToString:@"Google"]) {
        return @"GOOG";
    }

    return nil;
}
</code></pre>

<p>å¯ä»¥ä½¿ç”¨findStockCode:æ–¹æ³•æ¥è·å–æŸä¸ªä¸Šå¸‚å…¬å¸çš„è‚¡ç¥¨ä»£ç ã€‚<br/>
ä¹Ÿæœ‰çš„å¼€å‘è€…ä¼šä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥å†™ï¼Œæ‰¾ä¸åˆ°çš„æ—¶å€™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</p>

<pre><code class="objc">- (NSString *)findStockCode:(NSString *)company {
    if ([company isEqualToString:@"Apple"]) {
        return @"AAPL";
    } else if ([company isEqualToString:@"Google"]) {
        return @"GOOG";
    }

    return "";
}
</code></pre>

<p>å¦‚ä½•ç¡®å®šæ‰¾ä¸åˆ°è¯¥å…¬å¸ä»£ç çš„æ—¶å€™ï¼Œè¿”å›çš„æ˜¯ç©ºå­—ç¬¦ä¸²è¿˜æ˜¯nilå‘¢ï¼Ÿè°ƒç”¨è¯¥æ–¹æ³•çš„å¼€å‘è€…ï¼Œéœ€è¦é˜…è¯»æ–‡æ¡£æˆ–è€…å¤„ç†å¤šç§æƒ…å†µã€‚</p>

<pre><code class="objc">NSString *stockCode = [self findStockCode:@"Facebook"]; 
if (stockCode == "" &amp;&amp; stockCode == nil) {
    .....
}
</code></pre>

<p>åœ¨Swiftä¸­ï¼Œè¿™ç§æƒ…å†µéå¸¸æ˜æ˜¾çš„è¦ä½¿ç”¨Optionalã€‚å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™è¿”å›nilã€‚</p>

<pre><code class="swift">func findStockCode (company : String) -&gt; String? {
    if (company == "Apple") {
        return "AAPL"
    } else if(company == "Google") {
        return "GOOG"
    }

    return nil
}
</code></pre>

<h2>ä½¿ç”¨ç†ç”±2: ç¼–è¯‘çš„æ—¶å€™æç¤ºé”™è¯¯</h2>

<pre><code class="objc">- (NSString *)findStockCode:(NSString *)company {
    if ([company isEqualToString:@"Apple"]) {
        return @"AAPL";
    } else if ([company isEqualToString:@"Google"]) {
        return @"GOOG";
    }

    return nil;
}

NSString *stockCode = [self findStockCode:@"Facebook"]; // nil is returned
NSString *text = @"Stock Code - ";
NSString *message = [text stringByAppendingString:stockCode]; // runtime error
NSLog(@"%@", message);
</code></pre>

<p>å½“ç”¨Objective-Cçš„æ—¶å€™ï¼Œ<code>[text stringByAppendingString:stockCode]</code>ä¸­ï¼Œç»™NSStringæ·»åŠ nilçš„æ—¶å€™ï¼Œåœ¨è¿è¡Œæ—¶å‡ºé”™ã€‚</p>

<pre><code class="swift">func findStockCode(company: String) -&gt; String? {
   if (company == "Apple") {
      return "AAPL"
   } else if (company == "Google") {
      return "GOOG"
   }

   return nil
}

var stockCode:String? = findStockCode("Facebook")
let text = "Stock Code - "
let message = text + stockCode  // compile-time error
print(message)
</code></pre>

<p>å½“ç”¨Swiftçš„æ—¶å€™ï¼Œ<code>let message = text + stockCode</code>ä¸­ï¼ŒXcodeä¼šä¸»åŠ¨æç¤ºstockCodeå¯èƒ½ä¼šæ˜¯nilçš„æƒ…å†µï¼Œéœ€è¦å¼€å‘è€…è¿›ä¸€æ­¥å¤„ç†ã€‚</p>

<h2>ä½¿ç”¨ç†ç”±3: å¼ºè¿«æ€è€ƒnilé—®é¢˜ï¼Œcrashå®¹æ˜“å‘ç°é—®é¢˜</h2>

<p>ä¸Šé¢çš„Swiftä»£ç ä¸­ï¼Œè¦è§£å†³complile-time errorï¼Œå¯ä»¥ç”¨åŠ ï¼æ¥forced unwrappingã€‚</p>

<pre><code class="swift">var stockCode:String? = findStockCode("Facebook")
let text = "Stock Code - "
let message = text + stockCode!  // runtime error
</code></pre>

<p>è¿™æ®µä»£ç å¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯åœ¨runtimeçš„æ—¶å€™ï¼Œè¿˜æ˜¯ä¼šå‡ºé”™ã€‚<br/>
æŠ›å‡ºï¼šâ€œfatal error: Canâ€™t unwrap Optional.Noneâ€ã€‚<br/>
åœ¨ä½¿ç”¨ï¼è¿›è¡Œforced unwrappingçš„æ—¶å€™ï¼Œå¼€å‘è€…è¢«è¿«æ€è€ƒæ˜¯è¦forced unwrappingï¼Œè¿˜æ˜¯stockCodeæœ‰å¯èƒ½æ˜¯nilã€‚<br/>
è¿™æœ‰åˆ©äºå‡å°‘çŠ¯é”™çš„æœºä¼šã€‚è€Œå¦‚æœå‡ºé”™äº†ï¼Œæç¤ºçš„æ¶ˆæ¯ä¹Ÿéå¸¸å®¹æ˜“æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ã€‚</p>

<h2>ä½¿ç”¨ç†ç”±4: ç®€åŒ–nilæ£€æŸ¥å†™æ³•(optional chaining)</h2>

<p>è€ƒè™‘è¿™ä¸ªä¾‹å­</p>

<pre><code class="swift">class Stock {
    var code: String? 
    var price: Double? 
}

func findStockCode(company: String) -&gt; Stock? {
    if (company == "Apple") {
        let aapl: Stock = Stock()
        aapl.code = "AAPL"
        aapl.price = 90.32

        return aapl
    } else if (company == "Google") {
        let goog: Stock = Stock()
        goog.code = "GOOG"
        goog.price = 556.36

        return goog
    }

    return nil
}

if let sharePrice = findStockCode("Apple")?.price {
    let totalCost = sharePrice * 100
    print(totalCost)
}
</code></pre>

<p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œè¿›è¡Œäº†2æ¬¡nilæ£€æŸ¥ï¼Œä¸€æ¬¡æ˜¯åˆ¤æ–­findStockCode(&ldquo;Apple&rdquo;)æ˜¯å¦ä¸ºnilï¼Œä¸€æ¬¡æ˜¯åˆ¤æ–­findStockCode(&ldquo;Apple&rdquo;).priceæ˜¯å¦ä¸ºnilã€‚ä½¿ç”¨optional chainingï¼Œå¯ä»¥ç®€åŒ–nilæ£€æŸ¥å†™æ³•ã€‚</p>

<h3>å‚è€ƒæ–‡çŒ®</h3>

<p><a href="https://www.appcoda.com/beginners-guide-optionals-swift/">A Beginnerâ€™s Guide to Optionals in Swift</a><br/>
<a href="http://blog.teamtreehouse.com/understanding-optionals-swift">Understanding Optionals in Swift</a></p>
]]></content>
  </entry>
  
</feed>
